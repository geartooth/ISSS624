<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mah Lian Khye">
<meta name="dcterms.date" content="2023-12-14">

<title>ISSS624 - Take-home_Ex2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex01/Hands-on_Ex1.html" rel="" target="">
 <span class="dropdown-text">Ex 1 part 1 Data Wrangling with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex01/Hands-on_Ex1_part_2.html" rel="" target="">
 <span class="dropdown-text">Ex 1 part 2 Choropleth Mapping with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex02/Hands-on_Ex2_1.html" rel="" target="">
 <span class="dropdown-text">Ex 2 part 1 Spatial Weights &amp; Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex02/Hands-on_Ex2_2.html" rel="" target="">
 <span class="dropdown-text">Ex 2 part 2 Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex02/Hands-on_Ex2_3.html" rel="" target="">
 <span class="dropdown-text">Ex 2 part 3 Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex03/Hands-on_Ex3.html" rel="" target="">
 <span class="dropdown-text">Ex 3 Processing and Visualising Flow Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../In-class_Ex/Ex1/In-class_Ex1.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/Ex2/In-class_Ex2.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2 Spatial Weights</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/Ex2/In-class_Ex2_LISA.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2 GLSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/Ex2/In-class_Ex2_EHSA.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2 EHSA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/Ex3/In_class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/Ex4/In-class_Ex4.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../Take_home_Ex1/Take_home_Ex1.html" rel="" target="">
 <span class="dropdown-text">Take home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">ISSS624</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective">Objective</a></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">Tasks</a></li>
  <li><a href="#importing-packages-and-data" id="toc-importing-packages-and-data" class="nav-link" data-scroll-target="#importing-packages-and-data">Importing packages and data</a></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing">Data processing</a>
  <ul class="collapse">
  <li><a href="#assigning-individual-bus-stop-to-hexagons" id="toc-assigning-individual-bus-stop-to-hexagons" class="nav-link" data-scroll-target="#assigning-individual-bus-stop-to-hexagons">Assigning individual bus stop to hexagons</a></li>
  <li><a href="#duplication-check" id="toc-duplication-check" class="nav-link" data-scroll-target="#duplication-check">Duplication check</a>
  <ul class="collapse">
  <li><a href="#joining-destination-table-and-grid" id="toc-joining-destination-table-and-grid" class="nav-link" data-scroll-target="#joining-destination-table-and-grid">Joining destination table and grid</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#originproduction-constrained-sim" id="toc-originproduction-constrained-sim" class="nav-link" data-scroll-target="#originproduction-constrained-sim">Origin(Production) constrained SIM</a>
  <ul class="collapse">
  <li><a href="#goodness-of-fit" id="toc-goodness-of-fit" class="nav-link" data-scroll-target="#goodness-of-fit">Goodness-of-fit</a></li>
  </ul></li>
  <li><a href="#doubly-constrained-model" id="toc-doubly-constrained-model" class="nav-link" data-scroll-target="#doubly-constrained-model">Doubly constrained model</a>
  <ul class="collapse">
  <li><a href="#goodness-of-fit-1" id="toc-goodness-of-fit-1" class="nav-link" data-scroll-target="#goodness-of-fit-1">Goodness-of-fit</a></li>
  </ul></li>
  <li><a href="#unconstrained-model" id="toc-unconstrained-model" class="nav-link" data-scroll-target="#unconstrained-model">Unconstrained model</a>
  <ul class="collapse">
  <li><a href="#goodness-of-fit-2" id="toc-goodness-of-fit-2" class="nav-link" data-scroll-target="#goodness-of-fit-2">Goodness-of-fit</a></li>
  </ul></li>
  <li><a href="#destination-constrained-model" id="toc-destination-constrained-model" class="nav-link" data-scroll-target="#destination-constrained-model">Destination constrained model</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison</a></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a>
  <ul class="collapse">
  <li><a href="#unconstrained" id="toc-unconstrained" class="nav-link" data-scroll-target="#unconstrained">Unconstrained</a></li>
  <li><a href="#origin-constrained" id="toc-origin-constrained" class="nav-link" data-scroll-target="#origin-constrained">Origin constrained</a></li>
  <li><a href="#destination-constrained" id="toc-destination-constrained" class="nav-link" data-scroll-target="#destination-constrained">Destination constrained</a></li>
  <li><a href="#doubly-constrained" id="toc-doubly-constrained" class="nav-link" data-scroll-target="#doubly-constrained">Doubly constrained</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home_Ex2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mah Lian Khye </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 14, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 14, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>Organising bodies will have to consider passenger usage to and from locations when adding, changing or removing current transportation routes. Any alterations to present routes can lead to passengers having to seek alternate travelling options that can impact travel time and distance. To minimise the impact, the travelling routes taken will have to be surveyed thorugh commuters survey. However this form of sampling can be inefficient and will easily be out of date. The use of passenger tracking methods such as GPS or smart card boarding and alighting locations may be used as a substitute that can generate data more readily.</p>
</section>
<section id="objective" class="level1">
<h1>Objective</h1>
<p>The main objectives of this exercise is to analyse the boarding and alighting locations of passengers of a time interval. This analysis will allow us to track the factors that affect urban mobility so that route usage may be analyse for future route planning.</p>
</section>
<section id="tasks" class="level1">
<h1>Tasks</h1>
<p>The tasks of this exercise are as follow: - Derive an analytical hexagon map to be used as a traffic analysis zone - Construct an O-D matrix of commuter flow for weekday mornings from 6am to 9am - Display the O-D flows - Assemble at least 3 propulsive and 3 attractiveness variables - Compute a distance matrix - Calibrate spatial interactive models and present the modelling results using geovisualisation and graphical visualisation methods</p>
</section>
<section id="importing-packages-and-data" class="level1">
<h1>Importing packages and data</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Import packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Import data</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Firstly, we will import the various packages that we will need for this exercise.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, sp, DT, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               performance, reshape2,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggpubr, tidyverse,spdep, dplyr, sfdep, stplanr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><strong>Loading aspatial table</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Loading geospatial data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Here we will import the ridership of the different bus stops in Oct 2023.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>odbus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202310.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 5694297 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): YEAR_MONTH, DAY_TYPE, PT_TYPE, ORIGIN_PT_CODE, DESTINATION_PT_CODE
dbl (2): TIME_PER_HOUR, TOTAL_TRIPS

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Next we will extract the ridership for weekdays from 6am to 9am only.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>weekdayAM <span class="ot">&lt;-</span> odbus <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_PT_CODE,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>           DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ORIGIN_PT_CODE'. You can override using
the `.groups` argument.</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Next we will import all of the bus stops and their coordinates and attached it to the <em>busstop</em> variable.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>busstop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5161 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>stn <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"RapidTransitSystemStation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `RapidTransitSystemStation' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL
Message 1: Non closed ring detected. To avoid accepting it, set the
OGR_GEOMETRY_ACCEPT_UNCLOSED_RING configuration option to NO</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 220 features and 4 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58
Projected CRS: SVY21</code></pre>
</div>
</div>
<p>We will first rename the bus stop column title for easier data joining.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(busstop)[<span class="fu">colnames</span>(busstop) <span class="sc">==</span> <span class="st">"BUS_STOP_N"</span>] <span class="ot">&lt;-</span> <span class="st">"ORIGIN_PT_CODE"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will also import the layout of Singapore for excluding bus stops that are not found in Singapore.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"MPSZ-2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MPSZ-2019' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 332 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>After that we will create the hexagons that will create the map layout. All of the hexagons will also be given a grid id name that can be used for identifying each individual grid.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>area_honeycomb_grid <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(busstop, <span class="at">cellsize =</span> <span class="dv">750</span>, <span class="at">what =</span> <span class="st">"polygons"</span>, <span class="at">square =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>honeycomb_grid_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(area_honeycomb_grid) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grid_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">lengths</span>(area_honeycomb_grid)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-processing" class="level1">
<h1>Data processing</h1>
<section id="assigning-individual-bus-stop-to-hexagons" class="level2">
<h2 class="anchored" data-anchor-id="assigning-individual-bus-stop-to-hexagons">Assigning individual bus stop to hexagons</h2>
<p>First we will assign the bus stop point geometry data to each polygon using <em>st_intersection()</em> of Singapore to obtain bus stops located locally followed by another intersection with the hexagon map. The function assigns all of the points to a polygon by the point-set intersection of two geometries. Additional information <a href="https://postgis.net/docs/ST_Intersection.html">here</a>.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>valid_busstop <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(busstop, mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>busstop_hex <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(valid_busstop, honeycomb_grid_sf) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>busstop_hex <span class="ot">&lt;-</span> <span class="fu">unique</span>(busstop_hex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#here to test using mpsz instead of hex</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># busstop_hex &lt;- st_intersection(busstop, mpsz) %&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(ORIGIN_PT_CODE, SUBZONE_C) %&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(grid_id = SUBZONE_C) %&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   st_drop_geometry()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="duplication-check" class="level2">
<h2 class="anchored" data-anchor-id="duplication-check">Duplication check</h2>
<p>Here we will check for the presence of any duplication before we further process the data.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>duplicate <span class="ot">&lt;-</span> weekdayAM <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>duplicate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 3
# ℹ 3 variables: ORIGIN_PT_CODE &lt;chr&gt;, DESTINATION_PT_CODE &lt;chr&gt;, TRIPS &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Finally we will only keep data points that are unique using the <em>unique()</em> function.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>unique_weekdayAM <span class="ot">&lt;-</span> <span class="fu">unique</span>(weekdayAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="joining-destination-table-and-grid" class="level3">
<h3 class="anchored" data-anchor-id="joining-destination-table-and-grid">Joining destination table and grid</h3>
<p>Using the grid that we have created in the beginning, we will now join the data that contains the destination together with the grid.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>combn_des_weekdayAM <span class="ot">&lt;-</span> <span class="fu">left_join</span>(unique_weekdayAM,busstop_hex) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_GRID =</span> grid_id,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_BS =</span> DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ORIGIN_PT_CODE)`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(unique_weekdayAM, busstop_hex): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 113425 of `x` matches multiple rows in `y`.
ℹ Row 3054 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(combn_des_weekdayAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 242,497 × 4
# Groups:   ORIGIN_BS [5,029]
   ORIGIN_BS DESTIN_BS TRIPS ORIGIN_GRID
   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;       &lt;int&gt;
 1 01012     01112       290        1474
 2 01012     01113       118        1474
 3 01012     01121        77        1474
 4 01012     01211       118        1474
 5 01012     01311       165        1474
 6 01012     07371        14        1474
 7 01012     60011        30        1474
 8 01012     60021        16        1474
 9 01012     60031        35        1474
10 01012     60159        26        1474
# ℹ 242,487 more rows</code></pre>
</div>
</div>
<p>Here we will join the destination grid ID.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>OD_weekdayAM <span class="ot">&lt;-</span> <span class="fu">left_join</span>(combn_des_weekdayAM , busstop_hex,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DESTIN_BS"</span> <span class="ot">=</span> <span class="st">"ORIGIN_PT_CODE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(combn_des_weekdayAM, busstop_hex, by = c(DESTIN_BS = "ORIGIN_PT_CODE")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 637 of `x` matches multiple rows in `y`.
ℹ Row 3139 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<p>To make it clearer we will rename the <strong>grid_ID</strong> column, which is the destination grid id into <strong>DESTIN_GRID</strong>.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>OD_weekdayAM <span class="ot">&lt;-</span> OD_weekdayAM <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_GRID =</span> grid_id)<span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()<span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_GRID, DESTIN_GRID) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ORIGIN_GRID'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>We will have to remove any intra hexagonal trips.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>OD_weekdayAM <span class="ot">&lt;-</span> OD_weekdayAM[OD_weekdayAM<span class="sc">$</span>ORIGIN_GRID<span class="sc">!=</span>OD_weekdayAM<span class="sc">$</span>DESTIN_GRID,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here we will create the desire lines from the different origin grids and destination grids.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing flowline for flowdata</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>OD_weekdayAM <span class="ot">&lt;-</span> <span class="fu">od2line</span>(<span class="at">flow =</span> OD_weekdayAM, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zones =</span> honeycomb_grid_sf,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">zone_code =</span> <span class="st">"grid_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Creating centroids representing desire line start and end points.</code></pre>
</div>
</div>
<p>EVERYTHING ABOVE IS HOE3</p>
<p>We will recreate the hexagonal-polygon data so that we are able to map out the hexagons onto the Singapore map.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>valid_hex <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(valid_busstop, honeycomb_grid_sf)<span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>valid_hex <span class="ot">&lt;-</span> <span class="fu">left_join</span>(honeycomb_grid_sf, valid_hex) <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(grid_id)`</code></pre>
</div>
</div>
<p>We can visualise the flow of bus passengers of more than 5000 ridership from each origin grid to the destination grid.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(valid_hex) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>OD_weekdayAM <span class="sc">%&gt;%</span>  </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TRIPS <span class="sc">&gt;=</span> <span class="dv">5000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>(<span class="at">lwd =</span> <span class="st">"TRIPS"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">style =</span> <span class="st">"quantile"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">6</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in g$scale * (x/maxW): longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take_home_Ex2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We will create a hex data conaining the grid id and the polygon information.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>hex <span class="ot">&lt;-</span> <span class="fu">left_join</span>( honeycomb_grid_sf,busstop_hex)<span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(grid_id)<span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()<span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(grid_id)`</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>hex<span class="ot">&lt;-</span><span class="fu">unique</span>(hex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>hex_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(hex, <span class="st">"Spatial"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>hex_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 831 
extent      : 3595.122, 48595.12, 26049.09, 50297.8  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 1
names       : grid_id 
min values  :      23 
max values  :    2505 </code></pre>
</div>
</div>
<p>Next we will calculate the distance between the grids.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>DIST <span class="ot">&lt;-</span> <span class="fu">spDists</span>(hex_sp, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DIST, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
 [1,]    0.000  750.000 3269.174 1500.000 2704.163 3968.627 1299.038 2250.000
 [2,]  750.000    0.000 2598.076  750.000 1984.313 3269.174  750.000 1500.000
 [3,] 3269.174 2598.076    0.000 1984.313  750.000  750.000 2704.163 1500.000
 [4,] 1500.000  750.000 1984.313    0.000 1299.038 2598.076  750.000  750.000
 [5,] 2704.163 1984.313  750.000 1299.038    0.000 1299.038 1984.313  750.000
 [6,] 3968.627 3269.174  750.000 2598.076 1299.038    0.000 3269.174 1984.313
 [7,] 1299.038  750.000 2704.163  750.000 1984.313 3269.174    0.000 1299.038
 [8,] 2250.000 1500.000 1500.000  750.000  750.000 1984.313 1299.038    0.000
 [9,] 3436.932 2704.163  750.000 1984.313  750.000  750.000 2598.076 1299.038
[10,] 4683.748 3968.627 1500.000 3269.174 1984.313  750.000 3897.114 2598.076
          [,9]    [,10]
 [1,] 3436.932 4683.748
 [2,] 2704.163 3968.627
 [3,]  750.000 1500.000
 [4,] 1984.313 3269.174
 [5,]  750.000 1984.313
 [6,]  750.000  750.000
 [7,] 2598.076 3897.114
 [8,] 1299.038 2598.076
 [9,]    0.000 1299.038
[10,] 1299.038    0.000</code></pre>
</div>
</div>
<p>We will then rename the column and row names.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a> sz_names <span class="ot">&lt;-</span> hex<span class="sc">$</span>grid_id</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sz_names &lt;- hex$SUBZONE_C</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DIST) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(DIST) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can then pivot the dataframe to form a table.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(DIST) <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DIST =</span> value)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Var1 Var2     DIST
1    23   23    0.000
2    44   23  750.000
3    46   23 3269.174
4    66   23 1500.000
5    67   23 2704.163
6    68   23 3968.627
7    86   23 1299.038
8    87   23 2250.000
9    88   23 3436.932
10   89   23 4683.748</code></pre>
</div>
</div>
<p>Here we will substitute any distance of 0 with 50m.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DIST <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1           Var2           DIST      
 Min.   :  23   Min.   :  23   Min.   :  750  
 1st Qu.: 871   1st Qu.: 871   1st Qu.: 8250  
 Median :1326   Median :1326   Median :13269  
 Mean   :1270   Mean   :1270   Mean   :14135  
 3rd Qu.:1689   3rd Qu.:1689   3rd Qu.:18929  
 Max.   :2505   Max.   :2505   Max.   :44680  </code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>DIST <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>DIST <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">50</span>, distPair<span class="sc">$</span>DIST)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1           Var2           DIST      
 Min.   :  23   Min.   :  23   Min.   :   50  
 1st Qu.: 871   1st Qu.: 871   1st Qu.: 8250  
 Median :1326   Median :1326   Median :13269  
 Mean   :1270   Mean   :1270   Mean   :14118  
 3rd Qu.:1689   3rd Qu.:1689   3rd Qu.:18929  
 Max.   :2505   Max.   :2505   Max.   :44680  </code></pre>
</div>
</div>
<p>We can then rename the column names.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will reassign the variable name for subsequent processing.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> OD_weekdayAM</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># flow_data &lt;- OD_weekdayAM %&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(ORIGIN_GRID, DESTIN_GRID) %&gt;% </span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(TRIPS = sum(TRIPS)) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here we will join the distance between grids and their respective origin-destination grid pairs.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (distPair,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_GRID"</span> <span class="ot">=</span> <span class="st">"orig"</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_GRID"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>SKIP POP SECTION</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flow_data1,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(DIST),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">log</span>(TRIPS))) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take_home_Ex2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>EVERYTHING ABOVE IS IN CLASS3</p>
<p>Here we will import the school distribution information across Singapore.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>schools <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/schools.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 350 Columns: 41
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(35): school_name, url_address, address, telephone_no, telephone_no_2, f... dbl
(6): ...1, postal_code, results.X, results.Y, results.LATITUDE, results...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>schools <span class="ot">&lt;-</span> schools <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"latitude"</span> <span class="ot">=</span> <span class="st">"results.LATITUDE"</span>,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"longitude"</span> <span class="ot">=</span> <span class="st">"results.LONGITUDE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(postal_code, school_name, latitude, longitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will then convert the geeospatial information into 3414 coordinate reference.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>schools_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(schools, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally we will add this to the hexagon to count the number of schools within each hex.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>SCHOOL_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, schools_sf))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>SCHOOL_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.4128  1.0000  4.0000 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)  <span class="co">#polygon may not close, so need to auto close</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz)<span class="sc">+</span>  <span class="co">#sg boundary</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hex)<span class="sc">+</span>  <span class="co">#sg boundary</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span>  <span class="co">#sg boundary</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(schools_sf)<span class="sc">+</span>  <span class="co">#biz layer</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The shape mpsz is invalid. See sf::st_is_valid</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take_home_Ex2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>hdb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/hdb.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 12442 Columns: 37
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(18): blk_no, street, residential, commercial, market_hawker, miscellane... dbl
(19): ...1, max_floor_lvl, year_completed, total_dwelling_units, 1room_s...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>hdb_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(hdb, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lng"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>HDB_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, hdb_sf))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>HDB_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     0.0     0.0    14.9    27.0   103.0 </code></pre>
</div>
</div>
<p>We will do the same for businesses.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>biz_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"Business"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Business' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 6550 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>BIZ_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, biz_sf))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>BIZ_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     0.0     1.0     7.3     7.0    97.0 </code></pre>
</div>
</div>
<p>For FinServ</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fin_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"FinServ"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `FinServ' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 3320 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>FIN_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, fin_sf))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>FIN_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   1.000   3.936   4.000 139.000 </code></pre>
</div>
</div>
<p>For F&amp;B</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>fnb_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"F&amp;B"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `F&amp;B' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1919 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>FNB_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, fnb_sf))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>FNB_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   0.000   2.212   1.000 133.000 </code></pre>
</div>
</div>
<p>For retail</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>retail_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"Retails"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Retails' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 37635 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4737.982 ymin: 25171.88 xmax: 48265.04 ymax: 50135.28
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>retail_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, retail_sf))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>retail_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     1.0     8.0    44.2    37.0  1678.0 </code></pre>
</div>
</div>
<p>For entertainment</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>ent_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"entertn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `entertn' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 114 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 10809.34 ymin: 26528.63 xmax: 41600.62 ymax: 46375.77
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>ent_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, ent_sf))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>ent_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.1336  0.0000  9.0000 </code></pre>
</div>
</div>
<p>For LnR</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>lnr_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"Liesure&amp;Recreation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Liesure&amp;Recreation' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 1217 features and 30 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>lnr_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, lnr_sf))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>lnr_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   0.000   0.000   1.312   1.000  41.000 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>stn_exit_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"Train_Station_Exit_Layer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Train_Station_Exit_Layer' from data source 
  `C:\Users\Lian Khye\Desktop\MITB\Geospatial\geartooth\ISSS624\Take_home_Ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 565 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92
Projected CRS: SVY21</code></pre>
</div>
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>hex<span class="sc">$</span>stn_exit_COUNT <span class="ot">&lt;-</span> <span class="fu">lengths</span>(<span class="fu">st_intersects</span>(hex, stn_exit_sf))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hex<span class="sc">$</span>stn_exit_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.6739  0.0000 13.0000 </code></pre>
</div>
</div>
<p>use destination for pairing</p>
<p>Since the hex variable still contains geometry information, which will prevent us from joining the various school and business information with ridership, we will drop it.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#drop polygon from hex to retain line string</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>hex <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(hex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can then join the school and business count information to the ridership using left_join. Since this is for attractiveness, we will match the destination grid to the grid id.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>floD<span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (hex,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_GRID"</span> <span class="ot">=</span> <span class="st">"grid_id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Since we will log the data for modelling, we will have to convert any 0 value data in school and business count into a positive number that is less than 1. We will use 0.99.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>BIZ_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>BIZ_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>BIZ_COUNT)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>SCHOOL_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>SCHOOL_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>SCHOOL_COUNT)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>FIN_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>FIN_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>FIN_COUNT)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>FNB_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>FNB_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>FNB_COUNT)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>ent_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>ent_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>ent_COUNT)</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>lnr_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>lnr_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>lnr_COUNT)</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>stn_exit_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>stn_exit_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>stn_exit_COUNT)</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>HDB_COUNT <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>HDB_COUNT <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, floD<span class="sc">$</span>HDB_COUNT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>ORIGIN_GRID <span class="ot">&lt;-</span> <span class="fu">as.character</span>(floD<span class="sc">$</span>ORIGIN_GRID)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>DESTIN_GRID <span class="ot">&lt;-</span> <span class="fu">as.character</span>(floD<span class="sc">$</span>DESTIN_GRID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>ORIGIN_GRID <span class="sc">==</span> floD<span class="sc">$</span>DESTIN_GRID, <span class="dv">0</span>, floD<span class="sc">$</span>TRIPS</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>floD<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  floD<span class="sc">$</span>ORIGIN_GRID <span class="sc">==</span> floD<span class="sc">$</span>DESTIN_GRID, <span class="fl">0.000001</span>, <span class="dv">1</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> floD <span class="sc">%&gt;%</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FlowNoIntra <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow<span class="sc">%&gt;%</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print =</span> <span class="dv">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="originproduction-constrained-sim" class="level1">
<h1>Origin(Production) constrained SIM</h1>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>orcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                        ORIGIN_GRID <span class="sc">+</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#use attractiveness factors</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(BIZ_COUNT)<span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(SCHOOL_COUNT) <span class="sc">+</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(FIN_COUNT)<span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(FNB_COUNT)<span class="sc">+</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(ent_COUNT)<span class="sc">+</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(stn_exit_COUNT)<span class="sc">+</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(HDB_COUNT)<span class="sc">+</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(lnr_COUNT)<span class="sc">+</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(DIST) <span class="sc">-</span> <span class="dv">1</span>,  <span class="co">#have - 1 to remove intersept, already constrain to origin</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.action =</span> na.exclude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_GRID + log(BIZ_COUNT) + log(SCHOOL_COUNT) + 
    log(FIN_COUNT) + log(FNB_COUNT) + log(ent_COUNT) + log(stn_exit_COUNT) + 
    log(HDB_COUNT) + log(lnr_COUNT) + log(DIST) - 1, family = poisson(link = "log"), 
    data = inter_zonal_flow, na.action = na.exclude)

Coefficients:
                      Estimate Std. Error  z value Pr(&gt;|z|)    
ORIGIN_GRID1001     15.5006180  0.0243503   636.57   &lt;2e-16 ***
ORIGIN_GRID1003     18.1135582  0.0042707  4241.35   &lt;2e-16 ***
ORIGIN_GRID1004     19.0250483  0.0031977  5949.58   &lt;2e-16 ***
ORIGIN_GRID1011     14.9147590  0.0301008   495.49   &lt;2e-16 ***
ORIGIN_GRID1012     14.5350838  0.0317796   457.37   &lt;2e-16 ***
ORIGIN_GRID1013     15.2266944  0.0158164   962.72   &lt;2e-16 ***
ORIGIN_GRID1014     15.8662592  0.0105886  1498.43   &lt;2e-16 ***
ORIGIN_GRID1015     15.1752839  0.0158270   958.82   &lt;2e-16 ***
ORIGIN_GRID1016     16.7698241  0.0070984  2362.47   &lt;2e-16 ***
ORIGIN_GRID1018     17.1303002  0.0096920  1767.46   &lt;2e-16 ***
ORIGIN_GRID1019     18.5326626  0.0046289  4003.73   &lt;2e-16 ***
ORIGIN_GRID1023     17.0420089  0.0091933  1853.74   &lt;2e-16 ***
ORIGIN_GRID1024     18.1433654  0.0043656  4155.98   &lt;2e-16 ***
ORIGIN_GRID1025     13.6974986  0.0491280   278.81   &lt;2e-16 ***
ORIGIN_GRID1033     15.9285589  0.0110569  1440.60   &lt;2e-16 ***
ORIGIN_GRID1034     16.6665899  0.0071265  2338.67   &lt;2e-16 ***
ORIGIN_GRID1035     17.2483723  0.0054187  3183.12   &lt;2e-16 ***
ORIGIN_GRID1036     15.3188529  0.0138308  1107.59   &lt;2e-16 ***
ORIGIN_GRID1037     16.5416004  0.0069736  2372.03   &lt;2e-16 ***
ORIGIN_GRID1043     15.4541018  0.0246572   626.76   &lt;2e-16 ***
ORIGIN_GRID1045     17.7987953  0.0044723  3979.83   &lt;2e-16 ***
ORIGIN_GRID1046     17.8284895  0.0049468  3604.02   &lt;2e-16 ***
ORIGIN_GRID1053     17.2033982  0.0057096  3013.07   &lt;2e-16 ***
ORIGIN_GRID1054     16.4109049  0.0077264  2124.01   &lt;2e-16 ***
ORIGIN_GRID1055     17.2738772  0.0052000  3321.89   &lt;2e-16 ***
ORIGIN_GRID1056     16.1739607  0.0091318  1771.17   &lt;2e-16 ***
ORIGIN_GRID1064     12.5210411  0.2500099    50.08   &lt;2e-16 ***
ORIGIN_GRID1066     17.6914248  0.0049565  3569.36   &lt;2e-16 ***
ORIGIN_GRID1067     17.7534503  0.0065216  2722.25   &lt;2e-16 ***
ORIGIN_GRID1074     16.7709106  0.0075265  2228.24   &lt;2e-16 ***
ORIGIN_GRID1075     16.1677973  0.0099984  1617.03   &lt;2e-16 ***
ORIGIN_GRID1076     15.9863007  0.0085848  1862.17   &lt;2e-16 ***
ORIGIN_GRID1077     16.0173232  0.0100468  1594.27   &lt;2e-16 ***
ORIGIN_GRID1079     17.4504248  0.0051248  3405.13   &lt;2e-16 ***
ORIGIN_GRID1085     12.9403023  0.1414345    91.49   &lt;2e-16 ***
ORIGIN_GRID1087     17.6095438  0.0057536  3060.60   &lt;2e-16 ***
ORIGIN_GRID1088     16.1620792  0.0117643  1373.82   &lt;2e-16 ***
ORIGIN_GRID109      13.8157523  0.0990349   139.50   &lt;2e-16 ***
ORIGIN_GRID1094     14.8250858  0.0435292   340.58   &lt;2e-16 ***
ORIGIN_GRID1095     14.4504281  0.0327745   440.90   &lt;2e-16 ***
ORIGIN_GRID1096     15.7535184  0.0202152   779.29   &lt;2e-16 ***
ORIGIN_GRID1097     17.7749008  0.0038771  4584.61   &lt;2e-16 ***
ORIGIN_GRID1098     15.1370852  0.0179522   843.19   &lt;2e-16 ***
ORIGIN_GRID1099     16.7529812  0.0067939  2465.87   &lt;2e-16 ***
ORIGIN_GRID110      14.8426956  0.0716431   207.18   &lt;2e-16 ***
ORIGIN_GRID1105     14.4204606  0.0612360   235.49   &lt;2e-16 ***
ORIGIN_GRID1106     13.4537881  0.0916921   146.73   &lt;2e-16 ***
ORIGIN_GRID1107     15.2980593  0.0273896   558.53   &lt;2e-16 ***
ORIGIN_GRID1108     19.2876437  0.0027581  6993.13   &lt;2e-16 ***
ORIGIN_GRID1109     16.8722587  0.0101209  1667.07   &lt;2e-16 ***
ORIGIN_GRID111      17.1987876  0.0114373  1503.74   &lt;2e-16 ***
ORIGIN_GRID1116     16.5669156  0.0084200  1967.58   &lt;2e-16 ***
ORIGIN_GRID1117     14.8198851  0.0173655   853.41   &lt;2e-16 ***
ORIGIN_GRID1118     14.8636195  0.0190070   782.01   &lt;2e-16 ***
ORIGIN_GRID1119     15.9134395  0.0096567  1647.92   &lt;2e-16 ***
ORIGIN_GRID112      13.1356682  0.0641813   204.66   &lt;2e-16 ***
ORIGIN_GRID1120     15.7630904  0.0130506  1207.84   &lt;2e-16 ***
ORIGIN_GRID1129     17.9907879  0.0046871  3838.39   &lt;2e-16 ***
ORIGIN_GRID1130     18.2335442  0.0040050  4552.67   &lt;2e-16 ***
ORIGIN_GRID1131     17.0134851  0.0100212  1697.76   &lt;2e-16 ***
ORIGIN_GRID1136     15.3287031  0.0152295  1006.51   &lt;2e-16 ***
ORIGIN_GRID1138     14.3186924  0.0284871   502.64   &lt;2e-16 ***
ORIGIN_GRID1139     16.9658414  0.0052488  3232.31   &lt;2e-16 ***
ORIGIN_GRID1141     16.9215648  0.0063481  2665.59   &lt;2e-16 ***
ORIGIN_GRID1148     14.6234528  0.0516160   283.31   &lt;2e-16 ***
ORIGIN_GRID1149     15.9469990  0.0171662   928.97   &lt;2e-16 ***
ORIGIN_GRID1150     18.2927989  0.0036954  4950.14   &lt;2e-16 ***
ORIGIN_GRID1151     17.3518346  0.0064341  2696.85   &lt;2e-16 ***
ORIGIN_GRID1158     15.6965427  0.0110267  1423.50   &lt;2e-16 ***
ORIGIN_GRID1159     16.7947702  0.0057985  2896.42   &lt;2e-16 ***
ORIGIN_GRID1160     17.6706908  0.0039785  4441.57   &lt;2e-16 ***
ORIGIN_GRID1171     18.4563477  0.0039483  4674.52   &lt;2e-16 ***
ORIGIN_GRID1172     18.3950284  0.0038482  4780.18   &lt;2e-16 ***
ORIGIN_GRID1173     16.0948019  0.0123252  1305.85   &lt;2e-16 ***
ORIGIN_GRID1174     12.1754653  0.2672679    45.55   &lt;2e-16 ***
ORIGIN_GRID1178     15.7614783  0.0103587  1521.57   &lt;2e-16 ***
ORIGIN_GRID1179     16.4353255  0.0069235  2373.84   &lt;2e-16 ***
ORIGIN_GRID1180     17.2912554  0.0045069  3836.62   &lt;2e-16 ***
ORIGIN_GRID1181     16.4538299  0.0066364  2479.32   &lt;2e-16 ***
ORIGIN_GRID1183     15.6732686  0.0116938  1340.30   &lt;2e-16 ***
ORIGIN_GRID1190     14.8141260  0.0478809   309.39   &lt;2e-16 ***
ORIGIN_GRID1192     17.6771312  0.0061950  2853.45   &lt;2e-16 ***
ORIGIN_GRID1193     17.6109184  0.0052439  3358.38   &lt;2e-16 ***
ORIGIN_GRID1194     15.9236808  0.0138480  1149.89   &lt;2e-16 ***
ORIGIN_GRID1200     16.6959088  0.0067302  2480.74   &lt;2e-16 ***
ORIGIN_GRID1201     16.3814633  0.0071744  2283.32   &lt;2e-16 ***
ORIGIN_GRID1203     16.8694599  0.0060369  2794.37   &lt;2e-16 ***
ORIGIN_GRID1204     16.6776267  0.0069367  2404.27   &lt;2e-16 ***
ORIGIN_GRID1211     14.1453658  0.0891118   158.74   &lt;2e-16 ***
ORIGIN_GRID1214     18.1698821  0.0042067  4319.24   &lt;2e-16 ***
ORIGIN_GRID1215     15.0070543  0.0396774   378.23   &lt;2e-16 ***
ORIGIN_GRID1216     14.2271742  0.0403402   352.68   &lt;2e-16 ***
ORIGIN_GRID1220     17.6170638  0.0043432  4056.25   &lt;2e-16 ***
ORIGIN_GRID1221     17.1462410  0.0047458  3612.90   &lt;2e-16 ***
ORIGIN_GRID1222     16.8421584  0.0096962  1736.99   &lt;2e-16 ***
ORIGIN_GRID1223     14.9002897  0.0166987   892.30   &lt;2e-16 ***
ORIGIN_GRID1224     15.7196761  0.0106031  1482.55   &lt;2e-16 ***
ORIGIN_GRID1231     12.0784927  0.1889918    63.91   &lt;2e-16 ***
ORIGIN_GRID1232     13.6583102  0.1118244   122.14   &lt;2e-16 ***
ORIGIN_GRID1235     15.6738538  0.0136960  1144.41   &lt;2e-16 ***
ORIGIN_GRID1236     16.0585176  0.0136135  1179.60   &lt;2e-16 ***
ORIGIN_GRID1241     15.8384405  0.0100741  1572.19   &lt;2e-16 ***
ORIGIN_GRID1242     16.5457467  0.0068865  2402.64   &lt;2e-16 ***
ORIGIN_GRID1243     16.9871366  0.0050553  3360.24   &lt;2e-16 ***
ORIGIN_GRID1246     15.9154902  0.0092037  1729.25   &lt;2e-16 ***
ORIGIN_GRID1256     17.0410442  0.0074042  2301.55   &lt;2e-16 ***
ORIGIN_GRID1257     17.9148005  0.0052016  3444.08   &lt;2e-16 ***
ORIGIN_GRID1258     15.9860178  0.0143948  1110.54   &lt;2e-16 ***
ORIGIN_GRID1262     16.2800071  0.0082693  1968.72   &lt;2e-16 ***
ORIGIN_GRID1263     16.7811734  0.0054186  3096.95   &lt;2e-16 ***
ORIGIN_GRID1264     15.6822673  0.0117781  1331.48   &lt;2e-16 ***
ORIGIN_GRID1265     15.2426204  0.0139495  1092.70   &lt;2e-16 ***
ORIGIN_GRID1266     16.5725635  0.0078210  2118.98   &lt;2e-16 ***
ORIGIN_GRID1267     14.5768258  0.0266866   546.22   &lt;2e-16 ***
ORIGIN_GRID1272     12.3617258  0.1154863   107.04   &lt;2e-16 ***
ORIGIN_GRID1273     16.2300985  0.0119283  1360.64   &lt;2e-16 ***
ORIGIN_GRID1277     18.0236169  0.0041761  4315.94   &lt;2e-16 ***
ORIGIN_GRID1278     15.6704357  0.0137188  1142.26   &lt;2e-16 ***
ORIGIN_GRID128      16.4566072  0.0223367   736.75   &lt;2e-16 ***
ORIGIN_GRID1283     17.8760378  0.0041122  4347.03   &lt;2e-16 ***
ORIGIN_GRID1284     17.1305988  0.0049590  3454.44   &lt;2e-16 ***
ORIGIN_GRID1285     17.8101169  0.0036979  4816.24   &lt;2e-16 ***
ORIGIN_GRID1286     16.0095980  0.0100927  1586.26   &lt;2e-16 ***
ORIGIN_GRID1289     13.8895022  0.0460290   301.75   &lt;2e-16 ***
ORIGIN_GRID129      13.6214770  0.1889943    72.07   &lt;2e-16 ***
ORIGIN_GRID1293     12.9465420  0.0891108   145.29   &lt;2e-16 ***
ORIGIN_GRID1294     17.7370217  0.0060915  2911.76   &lt;2e-16 ***
ORIGIN_GRID1295     15.3190988  0.0205962   743.78   &lt;2e-16 ***
ORIGIN_GRID1298     16.9556246  0.0068665  2469.34   &lt;2e-16 ***
ORIGIN_GRID1299     17.5609551  0.0061482  2856.28   &lt;2e-16 ***
ORIGIN_GRID130      13.7402803  0.0602238   228.15   &lt;2e-16 ***
ORIGIN_GRID1304     17.7554983  0.0040576  4375.90   &lt;2e-16 ***
ORIGIN_GRID1305     17.1428217  0.0043998  3896.26   &lt;2e-16 ***
ORIGIN_GRID1307     13.5542759  0.0375825   360.65   &lt;2e-16 ***
ORIGIN_GRID1308     16.7352769  0.0062900  2660.64   &lt;2e-16 ***
ORIGIN_GRID131      14.5245113  0.0352994   411.47   &lt;2e-16 ***
ORIGIN_GRID1310     12.2479568  0.1302046    94.07   &lt;2e-16 ***
ORIGIN_GRID1316     14.2882467  0.0331416   431.13   &lt;2e-16 ***
ORIGIN_GRID1317     16.1139492  0.0112508  1432.25   &lt;2e-16 ***
ORIGIN_GRID1318     15.5265548  0.0152908  1015.42   &lt;2e-16 ***
ORIGIN_GRID1319     18.2541737  0.0040281  4531.76   &lt;2e-16 ***
ORIGIN_GRID132      14.1053874  0.0479881   293.94   &lt;2e-16 ***
ORIGIN_GRID1320     16.8972756  0.0089038  1897.75   &lt;2e-16 ***
ORIGIN_GRID1325     15.3976529  0.0123041  1251.43   &lt;2e-16 ***
ORIGIN_GRID1326     17.3265551  0.0043383  3993.82   &lt;2e-16 ***
ORIGIN_GRID1327     17.0388505  0.0047033  3622.71   &lt;2e-16 ***
ORIGIN_GRID1328     15.6106918  0.0094553  1651.00   &lt;2e-16 ***
ORIGIN_GRID1329     15.8992554  0.0115913  1371.65   &lt;2e-16 ***
ORIGIN_GRID133      13.9677685  0.0377403   370.10   &lt;2e-16 ***
ORIGIN_GRID1330     16.6681038  0.0081459  2046.18   &lt;2e-16 ***
ORIGIN_GRID1331     11.8880860  0.3015181    39.43   &lt;2e-16 ***
ORIGIN_GRID1333     15.7040953  0.0121861  1288.69   &lt;2e-16 ***
ORIGIN_GRID1334     16.0963022  0.0112488  1430.93   &lt;2e-16 ***
ORIGIN_GRID1335     15.5394218  0.0164966   941.98   &lt;2e-16 ***
ORIGIN_GRID1336     13.0938872  0.1072325   122.11   &lt;2e-16 ***
ORIGIN_GRID1337     13.6864342  0.0487281   280.87   &lt;2e-16 ***
ORIGIN_GRID1338     12.5261387  0.0814033   153.88   &lt;2e-16 ***
ORIGIN_GRID1339     18.1875931  0.0038977  4666.21   &lt;2e-16 ***
ORIGIN_GRID134      16.3122308  0.0233123   699.73   &lt;2e-16 ***
ORIGIN_GRID1340     16.5768222  0.0089000  1862.57   &lt;2e-16 ***
ORIGIN_GRID1341     11.5834634  0.7071108    16.38   &lt;2e-16 ***
ORIGIN_GRID1346     16.9335718  0.0062700  2700.71   &lt;2e-16 ***
ORIGIN_GRID1347     17.8189882  0.0036725  4851.95   &lt;2e-16 ***
ORIGIN_GRID1348     16.1473699  0.0063438  2545.39   &lt;2e-16 ***
ORIGIN_GRID1349     15.9688420  0.0081508  1959.19   &lt;2e-16 ***
ORIGIN_GRID1350     16.1148124  0.0111032  1451.37   &lt;2e-16 ***
ORIGIN_GRID1353     16.1608450  0.0084563  1911.11   &lt;2e-16 ***
ORIGIN_GRID1354     15.6634401  0.0120852  1296.09   &lt;2e-16 ***
ORIGIN_GRID1355     16.4923155  0.0084145  1959.98   &lt;2e-16 ***
ORIGIN_GRID1357     15.5851830  0.0187243   832.35   &lt;2e-16 ***
ORIGIN_GRID1358     16.8800538  0.0073177  2306.75   &lt;2e-16 ***
ORIGIN_GRID1359     17.3750059  0.0052807  3290.29   &lt;2e-16 ***
ORIGIN_GRID1360     17.4460907  0.0054280  3214.07   &lt;2e-16 ***
ORIGIN_GRID1361     18.3998910  0.0041319  4453.14   &lt;2e-16 ***
ORIGIN_GRID1362     14.4066100  0.0451754   318.90   &lt;2e-16 ***
ORIGIN_GRID1368     15.7823388  0.0085019  1856.33   &lt;2e-16 ***
ORIGIN_GRID1369     15.5884418  0.0086908  1793.67   &lt;2e-16 ***
ORIGIN_GRID1370     16.6926694  0.0051915  3215.36   &lt;2e-16 ***
ORIGIN_GRID1371     15.9966181  0.0099019  1615.52   &lt;2e-16 ***
ORIGIN_GRID1372     15.4559808  0.0131214  1177.92   &lt;2e-16 ***
ORIGIN_GRID1373     13.5305883  0.0464722   291.15   &lt;2e-16 ***
ORIGIN_GRID1374     15.2467222  0.0121842  1251.35   &lt;2e-16 ***
ORIGIN_GRID1375     16.8011486  0.0077066  2180.11   &lt;2e-16 ***
ORIGIN_GRID1376     16.2509686  0.0123146  1319.65   &lt;2e-16 ***
ORIGIN_GRID1379     14.6395816  0.0343419   426.29   &lt;2e-16 ***
ORIGIN_GRID1380     18.4483142  0.0033841  5451.39   &lt;2e-16 ***
ORIGIN_GRID1381     18.0790954  0.0039235  4607.88   &lt;2e-16 ***
ORIGIN_GRID1382     17.5510134  0.0063532  2762.53   &lt;2e-16 ***
ORIGIN_GRID1383     15.0002913  0.0240294   624.25   &lt;2e-16 ***
ORIGIN_GRID1388     16.2701542  0.0066401  2450.30   &lt;2e-16 ***
ORIGIN_GRID1389     15.4117336  0.0089216  1727.46   &lt;2e-16 ***
ORIGIN_GRID1390     16.0726856  0.0067744  2372.58   &lt;2e-16 ***
ORIGIN_GRID1391     15.8710403  0.0083618  1898.05   &lt;2e-16 ***
ORIGIN_GRID1392     15.6108222  0.0157914   988.57   &lt;2e-16 ***
ORIGIN_GRID1393     14.8995573  0.0149368   997.51   &lt;2e-16 ***
ORIGIN_GRID1394     16.1052608  0.0075762  2125.78   &lt;2e-16 ***
ORIGIN_GRID1395     16.1737486  0.0073999  2185.68   &lt;2e-16 ***
ORIGIN_GRID1396     17.2874466  0.0051959  3327.13   &lt;2e-16 ***
ORIGIN_GRID1397     17.3436527  0.0053065  3268.36   &lt;2e-16 ***
ORIGIN_GRID1398     16.3820465  0.0109341  1498.25   &lt;2e-16 ***
ORIGIN_GRID1400     17.6606323  0.0065439  2698.78   &lt;2e-16 ***
ORIGIN_GRID1401     17.7904011  0.0041449  4292.15   &lt;2e-16 ***
ORIGIN_GRID1402     17.9398210  0.0044797  4004.69   &lt;2e-16 ***
ORIGIN_GRID1404     17.5477533  0.0149392  1174.61   &lt;2e-16 ***
ORIGIN_GRID1410     16.7933658  0.0046090  3643.59   &lt;2e-16 ***
ORIGIN_GRID1411     15.6258554  0.0080475  1941.69   &lt;2e-16 ***
ORIGIN_GRID1412     16.0355294  0.0063936  2508.04   &lt;2e-16 ***
ORIGIN_GRID1413     16.9949584  0.0049565  3428.81   &lt;2e-16 ***
ORIGIN_GRID1414     16.3449105  0.0064674  2527.28   &lt;2e-16 ***
ORIGIN_GRID1415     15.7616917  0.0092797  1698.51   &lt;2e-16 ***
ORIGIN_GRID1416     16.4118031  0.0070957  2312.91   &lt;2e-16 ***
ORIGIN_GRID1417     16.4455922  0.0065416  2514.02   &lt;2e-16 ***
ORIGIN_GRID1418     17.3310242  0.0049680  3488.51   &lt;2e-16 ***
ORIGIN_GRID1419     16.8584738  0.0066337  2541.35   &lt;2e-16 ***
ORIGIN_GRID1422     17.8498477  0.0050512  3533.81   &lt;2e-16 ***
ORIGIN_GRID1423     18.8096993  0.0034829  5400.53   &lt;2e-16 ***
ORIGIN_GRID1430     16.4526836  0.0059860  2748.54   &lt;2e-16 ***
ORIGIN_GRID1431     16.4852764  0.0050012  3296.26   &lt;2e-16 ***
ORIGIN_GRID1432     16.5348160  0.0049429  3345.14   &lt;2e-16 ***
ORIGIN_GRID1433     15.2382373  0.0158566   961.00   &lt;2e-16 ***
ORIGIN_GRID1434     16.7826686  0.0055375  3030.72   &lt;2e-16 ***
ORIGIN_GRID1435     17.3077001  0.0042520  4070.46   &lt;2e-16 ***
ORIGIN_GRID1436     14.2407451  0.0219963   647.42   &lt;2e-16 ***
ORIGIN_GRID1437     17.3957857  0.0045027  3863.44   &lt;2e-16 ***
ORIGIN_GRID1438     17.8009215  0.0036105  4930.29   &lt;2e-16 ***
ORIGIN_GRID1439     18.4691020  0.0032440  5693.31   &lt;2e-16 ***
ORIGIN_GRID1440     14.8591689  0.0201386   737.85   &lt;2e-16 ***
ORIGIN_GRID1442     17.4395058  0.0066368  2627.72   &lt;2e-16 ***
ORIGIN_GRID1443     18.5301862  0.0037917  4887.08   &lt;2e-16 ***
ORIGIN_GRID1444     17.6807212  0.0073279  2412.80   &lt;2e-16 ***
ORIGIN_GRID1452     15.5448164  0.0076787  2024.41   &lt;2e-16 ***
ORIGIN_GRID1453     15.8228286  0.0074685  2118.60   &lt;2e-16 ***
ORIGIN_GRID1454     14.8952862  0.0181297   821.60   &lt;2e-16 ***
ORIGIN_GRID1455     16.1435107  0.0081448  1982.07   &lt;2e-16 ***
ORIGIN_GRID1456     16.7509777  0.0059913  2795.89   &lt;2e-16 ***
ORIGIN_GRID1457     17.5282818  0.0042763  4098.92   &lt;2e-16 ***
ORIGIN_GRID1458     17.6131540  0.0039393  4471.15   &lt;2e-16 ***
ORIGIN_GRID1459     17.2472949  0.0047426  3636.70   &lt;2e-16 ***
ORIGIN_GRID1460     16.5592233  0.0063348  2614.01   &lt;2e-16 ***
ORIGIN_GRID1461     15.2238051  0.0166220   915.88   &lt;2e-16 ***
ORIGIN_GRID1464     18.7854076  0.0036468  5151.24   &lt;2e-16 ***
ORIGIN_GRID1465     18.4160563  0.0047479  3878.80   &lt;2e-16 ***
ORIGIN_GRID1472     14.0462251  0.0188939   743.43   &lt;2e-16 ***
ORIGIN_GRID1473     15.1402900  0.0097008  1560.72   &lt;2e-16 ***
ORIGIN_GRID1474     16.2511144  0.0054199  2998.40   &lt;2e-16 ***
ORIGIN_GRID1475     17.2514352  0.0043035  4008.71   &lt;2e-16 ***
ORIGIN_GRID1476     16.7175490  0.0062568  2671.89   &lt;2e-16 ***
ORIGIN_GRID1477     18.0976920  0.0031257  5789.95   &lt;2e-16 ***
ORIGIN_GRID1478     16.4717801  0.0063385  2598.70   &lt;2e-16 ***
ORIGIN_GRID1479     16.6794740  0.0057873  2882.06   &lt;2e-16 ***
ORIGIN_GRID1480     18.4352534  0.0030470  6050.23   &lt;2e-16 ***
ORIGIN_GRID1481     16.0169094  0.0099672  1606.96   &lt;2e-16 ***
ORIGIN_GRID1482     15.9869784  0.0125649  1272.36   &lt;2e-16 ***
ORIGIN_GRID1485     18.1814340  0.0048865  3720.74   &lt;2e-16 ***
ORIGIN_GRID1494     15.3780994  0.0115804  1327.94   &lt;2e-16 ***
ORIGIN_GRID1495     15.5546544  0.0077718  2001.42   &lt;2e-16 ***
ORIGIN_GRID1496     16.6849655  0.0046864  3560.29   &lt;2e-16 ***
ORIGIN_GRID1497     17.0172752  0.0051927  3277.16   &lt;2e-16 ***
ORIGIN_GRID1498     17.5030942  0.0041879  4179.44   &lt;2e-16 ***
ORIGIN_GRID1499     17.6830650  0.0037853  4671.48   &lt;2e-16 ***
ORIGIN_GRID150      16.7326192  0.0198066   844.80   &lt;2e-16 ***
ORIGIN_GRID1500     17.5950663  0.0053256  3303.90   &lt;2e-16 ***
ORIGIN_GRID1501     17.7550486  0.0038351  4629.62   &lt;2e-16 ***
ORIGIN_GRID1502     17.4159169  0.0046790  3722.16   &lt;2e-16 ***
ORIGIN_GRID1506     13.2123647  0.1084858   121.79   &lt;2e-16 ***
ORIGIN_GRID151      14.3631874  0.0586562   244.87   &lt;2e-16 ***
ORIGIN_GRID1515     14.4511630  0.0210953   685.04   &lt;2e-16 ***
ORIGIN_GRID1516     16.0312618  0.0065509  2447.17   &lt;2e-16 ***
ORIGIN_GRID1517     16.2739556  0.0067381  2415.20   &lt;2e-16 ***
ORIGIN_GRID1518     16.4737519  0.0072509  2271.96   &lt;2e-16 ***
ORIGIN_GRID1519     17.9051340  0.0048050  3726.32   &lt;2e-16 ***
ORIGIN_GRID152      13.7866166  0.0811334   169.93   &lt;2e-16 ***
ORIGIN_GRID1520     17.1329153  0.0049549  3457.80   &lt;2e-16 ***
ORIGIN_GRID1521     15.6575668  0.0108882  1438.03   &lt;2e-16 ***
ORIGIN_GRID1522     18.0312593  0.0035930  5018.47   &lt;2e-16 ***
ORIGIN_GRID1523     16.3464975  0.0148747  1098.95   &lt;2e-16 ***
ORIGIN_GRID1524     16.6526104  0.0091156  1826.83   &lt;2e-16 ***
ORIGIN_GRID1527     16.1126330  0.0158613  1015.85   &lt;2e-16 ***
ORIGIN_GRID153      14.2812349  0.0415679   343.56   &lt;2e-16 ***
ORIGIN_GRID1535     12.9963019  0.0720069   180.49   &lt;2e-16 ***
ORIGIN_GRID1536     13.4599665  0.0321485   418.68   &lt;2e-16 ***
ORIGIN_GRID1537     14.6527848  0.0155203   944.11   &lt;2e-16 ***
ORIGIN_GRID1538     16.2060904  0.0060442  2681.28   &lt;2e-16 ***
ORIGIN_GRID1539     16.6586785  0.0050820  3278.00   &lt;2e-16 ***
ORIGIN_GRID154      16.9859401  0.0090195  1883.24   &lt;2e-16 ***
ORIGIN_GRID1540     17.3730801  0.0043864  3960.69   &lt;2e-16 ***
ORIGIN_GRID1541     18.6797362  0.0047232  3954.87   &lt;2e-16 ***
ORIGIN_GRID1542     15.6139297  0.0140532  1111.06   &lt;2e-16 ***
ORIGIN_GRID1543     16.0016634  0.0195012   820.55   &lt;2e-16 ***
ORIGIN_GRID1544     17.3080321  0.0063613  2720.84   &lt;2e-16 ***
ORIGIN_GRID1547     13.4987707  0.0575787   234.44   &lt;2e-16 ***
ORIGIN_GRID155      14.1327652  0.0328503   430.22   &lt;2e-16 ***
ORIGIN_GRID1556     14.0809104  0.0531813   264.77   &lt;2e-16 ***
ORIGIN_GRID1557     13.6756878  0.0307767   444.35   &lt;2e-16 ***
ORIGIN_GRID1558     15.1345755  0.0175803   860.88   &lt;2e-16 ***
ORIGIN_GRID1559     16.8406390  0.0047722  3528.87   &lt;2e-16 ***
ORIGIN_GRID156      15.0868309  0.0385952   390.90   &lt;2e-16 ***
ORIGIN_GRID1560     17.7188967  0.0036949  4795.45   &lt;2e-16 ***
ORIGIN_GRID1561     17.7401850  0.0045863  3868.12   &lt;2e-16 ***
ORIGIN_GRID1562     14.7088776  0.0188515   780.25   &lt;2e-16 ***
ORIGIN_GRID1563     16.3762042  0.0070761  2314.30   &lt;2e-16 ***
ORIGIN_GRID1564     15.5585322  0.0126370  1231.18   &lt;2e-16 ***
ORIGIN_GRID1565     15.5980958  0.0132802  1174.54   &lt;2e-16 ***
ORIGIN_GRID1566     15.1331487  0.0191090   791.94   &lt;2e-16 ***
ORIGIN_GRID1567     13.1952603  0.0764985   172.49   &lt;2e-16 ***
ORIGIN_GRID1568     13.5865796  0.0603341   225.19   &lt;2e-16 ***
ORIGIN_GRID1578     11.2886842  0.7071099    15.96   &lt;2e-16 ***
ORIGIN_GRID1580     15.4952673  0.0147647  1049.48   &lt;2e-16 ***
ORIGIN_GRID1581     14.1085751  0.0195705   720.91   &lt;2e-16 ***
ORIGIN_GRID1582     17.4439447  0.0038912  4482.96   &lt;2e-16 ***
ORIGIN_GRID1583     15.9896961  0.0196371   814.26   &lt;2e-16 ***
ORIGIN_GRID1584     16.1002355  0.0097255  1655.46   &lt;2e-16 ***
ORIGIN_GRID1585     16.5405511  0.0086351  1915.49   &lt;2e-16 ***
ORIGIN_GRID1586     15.6599170  0.0119826  1306.89   &lt;2e-16 ***
ORIGIN_GRID1589     13.8931874  0.0390346   355.92   &lt;2e-16 ***
ORIGIN_GRID1590     13.7883602  0.0574867   239.85   &lt;2e-16 ***
ORIGIN_GRID1600     17.3715993  0.0090707  1915.12   &lt;2e-16 ***
ORIGIN_GRID1601     15.9680119  0.0072107  2214.49   &lt;2e-16 ***
ORIGIN_GRID1602     16.8414736  0.0058767  2865.79   &lt;2e-16 ***
ORIGIN_GRID1603     17.7043513  0.0039427  4490.39   &lt;2e-16 ***
ORIGIN_GRID1604     16.1547126  0.0075021  2153.36   &lt;2e-16 ***
ORIGIN_GRID1605     17.4750245  0.0042174  4143.60   &lt;2e-16 ***
ORIGIN_GRID1606     17.1628982  0.0087553  1960.29   &lt;2e-16 ***
ORIGIN_GRID1607     16.1544893  0.0091407  1767.31   &lt;2e-16 ***
ORIGIN_GRID1608     17.8219039  0.0044101  4041.19   &lt;2e-16 ***
ORIGIN_GRID1609     17.5618520  0.0054138  3243.92   &lt;2e-16 ***
ORIGIN_GRID1610     13.9735811  0.0595834   234.52   &lt;2e-16 ***
ORIGIN_GRID1622     16.0825852  0.0197172   815.66   &lt;2e-16 ***
ORIGIN_GRID1623     17.3225554  0.0040711  4255.00   &lt;2e-16 ***
ORIGIN_GRID1624     16.1591258  0.0079048  2044.22   &lt;2e-16 ***
ORIGIN_GRID1625     17.5126425  0.0045266  3868.86   &lt;2e-16 ***
ORIGIN_GRID1626     18.0465545  0.0034375  5249.98   &lt;2e-16 ***
ORIGIN_GRID1627     16.4903343  0.0067783  2432.81   &lt;2e-16 ***
ORIGIN_GRID1628     18.1851390  0.0035329  5147.43   &lt;2e-16 ***
ORIGIN_GRID1629     16.9674309  0.0066684  2544.44   &lt;2e-16 ***
ORIGIN_GRID1630     16.8340386  0.0075189  2238.91   &lt;2e-16 ***
ORIGIN_GRID1631     13.3123673  0.0587571   226.57   &lt;2e-16 ***
ORIGIN_GRID1642     15.0370122  0.0270299   556.31   &lt;2e-16 ***
ORIGIN_GRID1643     17.2051819  0.0043966  3913.31   &lt;2e-16 ***
ORIGIN_GRID1644     15.1645532  0.0157861   960.63   &lt;2e-16 ***
ORIGIN_GRID1645     16.6980207  0.0058984  2830.93   &lt;2e-16 ***
ORIGIN_GRID1646     16.5250809  0.0083494  1979.19   &lt;2e-16 ***
ORIGIN_GRID1647     16.7904463  0.0055347  3033.66   &lt;2e-16 ***
ORIGIN_GRID1648     17.3464569  0.0047186  3676.17   &lt;2e-16 ***
ORIGIN_GRID1649     18.0072840  0.0037625  4785.94   &lt;2e-16 ***
ORIGIN_GRID1650     17.7257439  0.0051438  3446.07   &lt;2e-16 ***
ORIGIN_GRID1664     12.2127102  0.1666777    73.27   &lt;2e-16 ***
ORIGIN_GRID1665     17.4210436  0.0039998  4355.49   &lt;2e-16 ***
ORIGIN_GRID1666     16.1547624  0.0067654  2387.84   &lt;2e-16 ***
ORIGIN_GRID1667     17.3419447  0.0097354  1781.32   &lt;2e-16 ***
ORIGIN_GRID1668     17.3113897  0.0046180  3748.64   &lt;2e-16 ***
ORIGIN_GRID1670     18.2012083  0.0035158  5176.92   &lt;2e-16 ***
ORIGIN_GRID1671     18.6590687  0.0050361  3705.07   &lt;2e-16 ***
ORIGIN_GRID1672     17.7333707  0.0056591  3133.59   &lt;2e-16 ***
ORIGIN_GRID1684     16.5669927  0.0116773  1418.74   &lt;2e-16 ***
ORIGIN_GRID1685     17.0883198  0.0052420  3259.90   &lt;2e-16 ***
ORIGIN_GRID1686     16.7987051  0.0052555  3196.40   &lt;2e-16 ***
ORIGIN_GRID1687     16.6173219  0.0071343  2329.21   &lt;2e-16 ***
ORIGIN_GRID1688     16.0793336  0.0081298  1977.83   &lt;2e-16 ***
ORIGIN_GRID1689     15.6043830  0.0118469  1317.17   &lt;2e-16 ***
ORIGIN_GRID1690     17.1006388  0.0063696  2684.71   &lt;2e-16 ***
ORIGIN_GRID1691     17.7223630  0.0043897  4037.29   &lt;2e-16 ***
ORIGIN_GRID1692     16.8265470  0.0078589  2141.07   &lt;2e-16 ***
ORIGIN_GRID1706     17.0576191  0.0060838  2803.78   &lt;2e-16 ***
ORIGIN_GRID1707     16.8469851  0.0049630  3394.49   &lt;2e-16 ***
ORIGIN_GRID1708     17.4416337  0.0040971  4257.10   &lt;2e-16 ***
ORIGIN_GRID1709     16.4926214  0.0065186  2530.10   &lt;2e-16 ***
ORIGIN_GRID1710     17.7066525  0.0042052  4210.62   &lt;2e-16 ***
ORIGIN_GRID1711     17.4319534  0.0048895  3565.15   &lt;2e-16 ***
ORIGIN_GRID1712     18.0750238  0.0034809  5192.67   &lt;2e-16 ***
ORIGIN_GRID1713     15.5389183  0.0122613  1267.31   &lt;2e-16 ***
ORIGIN_GRID1714     17.9113477  0.0046027  3891.48   &lt;2e-16 ***
ORIGIN_GRID172      15.6193111  0.0758392   205.95   &lt;2e-16 ***
ORIGIN_GRID1727     17.1735983  0.0051801  3315.30   &lt;2e-16 ***
ORIGIN_GRID1728     17.0162300  0.0047661  3570.24   &lt;2e-16 ***
ORIGIN_GRID1729     16.6186340  0.0055689  2984.16   &lt;2e-16 ***
ORIGIN_GRID1730     14.7918760  0.0199914   739.91   &lt;2e-16 ***
ORIGIN_GRID1731     17.1589374  0.0054062  3173.94   &lt;2e-16 ***
ORIGIN_GRID1732     17.7915526  0.0037659  4724.39   &lt;2e-16 ***
ORIGIN_GRID1733     17.4341733  0.0045175  3859.23   &lt;2e-16 ***
ORIGIN_GRID1734     17.5736841  0.0043217  4066.39   &lt;2e-16 ***
ORIGIN_GRID1735     18.6331592  0.0057364  3248.23   &lt;2e-16 ***
ORIGIN_GRID174      14.2937458  0.0463128   308.63   &lt;2e-16 ***
ORIGIN_GRID1748     16.0925929  0.0092238  1744.68   &lt;2e-16 ***
ORIGIN_GRID1749     16.8475721  0.0050262  3351.96   &lt;2e-16 ***
ORIGIN_GRID175      16.5665875  0.0101710  1628.80   &lt;2e-16 ***
ORIGIN_GRID1750     16.0006357  0.0071741  2230.34   &lt;2e-16 ***
ORIGIN_GRID1751     15.7817338  0.0104721  1507.02   &lt;2e-16 ***
ORIGIN_GRID1753     17.8259605  0.0039655  4495.27   &lt;2e-16 ***
ORIGIN_GRID1754     18.0870874  0.0035098  5153.34   &lt;2e-16 ***
ORIGIN_GRID1755     17.4260898  0.0044558  3910.86   &lt;2e-16 ***
ORIGIN_GRID1756     17.2698226  0.0052680  3278.26   &lt;2e-16 ***
ORIGIN_GRID1757     15.1734350  0.0244148   621.49   &lt;2e-16 ***
ORIGIN_GRID176      17.7431435  0.0061626  2879.17   &lt;2e-16 ***
ORIGIN_GRID1769     16.8470176  0.0057226  2943.94   &lt;2e-16 ***
ORIGIN_GRID1770     16.8621081  0.0083167  2027.49   &lt;2e-16 ***
ORIGIN_GRID1771     15.6684307  0.0098745  1586.75   &lt;2e-16 ***
ORIGIN_GRID1772     15.2583171  0.0232810   655.40   &lt;2e-16 ***
ORIGIN_GRID1774     17.4820320  0.0043693  4001.14   &lt;2e-16 ***
ORIGIN_GRID1775     16.9893698  0.0054349  3125.95   &lt;2e-16 ***
ORIGIN_GRID1776     18.0151560  0.0035616  5058.17   &lt;2e-16 ***
ORIGIN_GRID1777     17.9835080  0.0039815  4516.75   &lt;2e-16 ***
ORIGIN_GRID1778     16.8060805  0.0107666  1560.94   &lt;2e-16 ***
ORIGIN_GRID1790     17.5057584  0.0048928  3577.86   &lt;2e-16 ***
ORIGIN_GRID1791     16.7025846  0.0063080  2647.86   &lt;2e-16 ***
ORIGIN_GRID1792     16.7492416  0.0064075  2614.01   &lt;2e-16 ***
ORIGIN_GRID1793     15.1349922  0.0133203  1136.23   &lt;2e-16 ***
ORIGIN_GRID1794     15.4426959  0.0272978   565.71   &lt;2e-16 ***
ORIGIN_GRID1795     14.2344915  0.0327524   434.61   &lt;2e-16 ***
ORIGIN_GRID1796     17.8347026  0.0042781  4168.85   &lt;2e-16 ***
ORIGIN_GRID1797     17.7270884  0.0039862  4447.13   &lt;2e-16 ***
ORIGIN_GRID1798     17.8071679  0.0039789  4475.38   &lt;2e-16 ***
ORIGIN_GRID1799     16.8599536  0.0075371  2236.92   &lt;2e-16 ***
ORIGIN_GRID1800     15.4198323  0.0268637   574.00   &lt;2e-16 ***
ORIGIN_GRID1811     16.6413088  0.0072045  2309.86   &lt;2e-16 ***
ORIGIN_GRID1812     17.6685083  0.0037371  4727.90   &lt;2e-16 ***
ORIGIN_GRID1813     17.5718352  0.0039949  4398.61   &lt;2e-16 ***
ORIGIN_GRID1817     17.4665467  0.0052639  3318.15   &lt;2e-16 ***
ORIGIN_GRID1818     17.5254571  0.0044025  3980.78   &lt;2e-16 ***
ORIGIN_GRID1819     17.8579048  0.0038003  4699.10   &lt;2e-16 ***
ORIGIN_GRID1820     14.6946454  0.0328103   447.87   &lt;2e-16 ***
ORIGIN_GRID1832     17.3414997  0.0052911  3277.51   &lt;2e-16 ***
ORIGIN_GRID1833     16.7293984  0.0059107  2830.38   &lt;2e-16 ***
ORIGIN_GRID1834     17.1888493  0.0046165  3723.33   &lt;2e-16 ***
ORIGIN_GRID1835     16.5345996  0.0073243  2257.51   &lt;2e-16 ***
ORIGIN_GRID1837     14.1556296  0.0607799   232.90   &lt;2e-16 ***
ORIGIN_GRID1839     16.9328764  0.0065796  2573.55   &lt;2e-16 ***
ORIGIN_GRID1840     18.6987393  0.0029739  6287.52   &lt;2e-16 ***
ORIGIN_GRID1841     14.2434711  0.0343526   414.62   &lt;2e-16 ***
ORIGIN_GRID1842     17.5770329  0.0104126  1688.05   &lt;2e-16 ***
ORIGIN_GRID1853     17.1702576  0.0050131  3425.06   &lt;2e-16 ***
ORIGIN_GRID1854     17.4701895  0.0046826  3730.91   &lt;2e-16 ***
ORIGIN_GRID1855     17.6570768  0.0042301  4174.12   &lt;2e-16 ***
ORIGIN_GRID1858     15.4344311  0.0252499   611.27   &lt;2e-16 ***
ORIGIN_GRID1860     17.8161896  0.0081745  2179.49   &lt;2e-16 ***
ORIGIN_GRID1861     17.6938334  0.0045544  3885.02   &lt;2e-16 ***
ORIGIN_GRID1874     17.4674706  0.0059489  2936.26   &lt;2e-16 ***
ORIGIN_GRID1875     15.7479365  0.0122989  1280.43   &lt;2e-16 ***
ORIGIN_GRID1876     17.5750798  0.0096227  1826.42   &lt;2e-16 ***
ORIGIN_GRID1877     17.3100796  0.0048288  3584.79   &lt;2e-16 ***
ORIGIN_GRID1880     14.0906707  0.0506127   278.40   &lt;2e-16 ***
ORIGIN_GRID1882     17.6209412  0.0049357  3570.11   &lt;2e-16 ***
ORIGIN_GRID1883     17.3749425  0.0085808  2024.87   &lt;2e-16 ***
ORIGIN_GRID1895     17.4555420  0.0047619  3665.69   &lt;2e-16 ***
ORIGIN_GRID1896     15.9057228  0.0096891  1641.62   &lt;2e-16 ***
ORIGIN_GRID1897     16.7553512  0.0086836  1929.54   &lt;2e-16 ***
ORIGIN_GRID1898     12.0329747  0.1324688    90.84   &lt;2e-16 ***
ORIGIN_GRID1901     14.1233044  0.0588613   239.94   &lt;2e-16 ***
ORIGIN_GRID1903     16.7070758  0.0086372  1934.31   &lt;2e-16 ***
ORIGIN_GRID1917     16.1620566  0.0089626  1803.28   &lt;2e-16 ***
ORIGIN_GRID1918     17.8471519  0.0056199  3175.69   &lt;2e-16 ***
ORIGIN_GRID1919     17.2934119  0.0051549  3354.75   &lt;2e-16 ***
ORIGIN_GRID1922     15.2873051  0.0282114   541.88   &lt;2e-16 ***
ORIGIN_GRID1924     16.7707371  0.0091263  1837.63   &lt;2e-16 ***
ORIGIN_GRID1937     16.8579877  0.0067219  2507.94   &lt;2e-16 ***
ORIGIN_GRID1938     17.6270560  0.0044784  3936.05   &lt;2e-16 ***
ORIGIN_GRID1939     18.1342508  0.0040516  4475.82   &lt;2e-16 ***
ORIGIN_GRID1942     14.1037428  0.0469237   300.57   &lt;2e-16 ***
ORIGIN_GRID195      13.2702628  0.0808667   164.10   &lt;2e-16 ***
ORIGIN_GRID1959     16.5090699  0.0084232  1959.96   &lt;2e-16 ***
ORIGIN_GRID196      13.7065233  0.0419314   326.88   &lt;2e-16 ***
ORIGIN_GRID1960     18.4086466  0.0030902  5957.10   &lt;2e-16 ***
ORIGIN_GRID1961     17.0710733  0.0067450  2530.91   &lt;2e-16 ***
ORIGIN_GRID1962     18.0307773  0.0043914  4105.91   &lt;2e-16 ***
ORIGIN_GRID1964     13.1402592  0.0880660   149.21   &lt;2e-16 ***
ORIGIN_GRID197      12.9904734  0.1097809   118.33   &lt;2e-16 ***
ORIGIN_GRID1979     16.7756922  0.0077154  2174.32   &lt;2e-16 ***
ORIGIN_GRID1980     15.2790721  0.0135305  1129.23   &lt;2e-16 ***
ORIGIN_GRID1981     17.6987798  0.0043505  4068.23   &lt;2e-16 ***
ORIGIN_GRID1982     16.6424736  0.0106536  1562.15   &lt;2e-16 ***
ORIGIN_GRID1983     18.0991251  0.0043737  4138.16   &lt;2e-16 ***
ORIGIN_GRID1984     16.8020364  0.0073428  2288.23   &lt;2e-16 ***
ORIGIN_GRID1985     17.2853630  0.0062243  2777.06   &lt;2e-16 ***
ORIGIN_GRID2001     17.0410413  0.0058191  2928.44   &lt;2e-16 ***
ORIGIN_GRID2002     17.7786733  0.0038807  4581.31   &lt;2e-16 ***
ORIGIN_GRID2003     17.3566108  0.0050686  3424.34   &lt;2e-16 ***
ORIGIN_GRID2004     18.1922583  0.0041551  4378.28   &lt;2e-16 ***
ORIGIN_GRID2005     17.9936250  0.0042005  4283.73   &lt;2e-16 ***
ORIGIN_GRID2006     16.5442651  0.0090711  1823.84   &lt;2e-16 ***
ORIGIN_GRID2007     15.9269411  0.0157274  1012.69   &lt;2e-16 ***
ORIGIN_GRID2022     17.6597821  0.0056922  3102.45   &lt;2e-16 ***
ORIGIN_GRID2023     18.0350631  0.0037820  4768.67   &lt;2e-16 ***
ORIGIN_GRID2024     17.3979807  0.0047479  3664.33   &lt;2e-16 ***
ORIGIN_GRID2025     17.5348160  0.0045958  3815.36   &lt;2e-16 ***
ORIGIN_GRID2026     16.1407877  0.0114120  1414.37   &lt;2e-16 ***
ORIGIN_GRID2027     18.1913899  0.0040683  4471.44   &lt;2e-16 ***
ORIGIN_GRID2043     16.8239235  0.0074829  2248.33   &lt;2e-16 ***
ORIGIN_GRID2044     17.7104312  0.0042589  4158.47   &lt;2e-16 ***
ORIGIN_GRID2045     13.5212213  0.0743558   181.84   &lt;2e-16 ***
ORIGIN_GRID2046     17.6136811  0.0039450  4464.76   &lt;2e-16 ***
ORIGIN_GRID2047     17.5564718  0.0050595  3470.01   &lt;2e-16 ***
ORIGIN_GRID2048     17.7515316  0.0046197  3842.53   &lt;2e-16 ***
ORIGIN_GRID2049     16.8620168  0.0135200  1247.19   &lt;2e-16 ***
ORIGIN_GRID2064     17.6605840  0.0048133  3669.14   &lt;2e-16 ***
ORIGIN_GRID2065     16.2651113  0.0081924  1985.38   &lt;2e-16 ***
ORIGIN_GRID2066     15.9042931  0.0204874   776.30   &lt;2e-16 ***
ORIGIN_GRID2067     18.7805840  0.0029257  6419.07   &lt;2e-16 ***
ORIGIN_GRID2068     17.6376242  0.0066974  2633.49   &lt;2e-16 ***
ORIGIN_GRID2069     17.5842192  0.0054326  3236.80   &lt;2e-16 ***
ORIGIN_GRID2085     16.4169844  0.0092217  1780.25   &lt;2e-16 ***
ORIGIN_GRID2086     17.9223638  0.0040763  4396.77   &lt;2e-16 ***
ORIGIN_GRID2087     16.6650914  0.0070709  2356.84   &lt;2e-16 ***
ORIGIN_GRID2088     17.2880722  0.0045514  3798.39   &lt;2e-16 ***
ORIGIN_GRID2089     16.9899745  0.0063958  2656.41   &lt;2e-16 ***
ORIGIN_GRID2090     18.3245625  0.0035753  5125.33   &lt;2e-16 ***
ORIGIN_GRID2091     14.2628610  0.0679134   210.01   &lt;2e-16 ***
ORIGIN_GRID2105     14.3730263  0.1010410   142.25   &lt;2e-16 ***
ORIGIN_GRID2106     14.9318014  0.0186582   800.28   &lt;2e-16 ***
ORIGIN_GRID2107     15.9912561  0.0090822  1760.73   &lt;2e-16 ***
ORIGIN_GRID2108     17.2866912  0.0053442  3234.64   &lt;2e-16 ***
ORIGIN_GRID2109     17.4763647  0.0044811  3900.05   &lt;2e-16 ***
ORIGIN_GRID2110     16.9821995  0.0071021  2391.15   &lt;2e-16 ***
ORIGIN_GRID2111     14.8641063  0.0392097   379.09   &lt;2e-16 ***
ORIGIN_GRID2128     15.9798349  0.0128485  1243.71   &lt;2e-16 ***
ORIGIN_GRID2129     15.3614227  0.0143619  1069.60   &lt;2e-16 ***
ORIGIN_GRID2130     17.7699458  0.0039409  4509.16   &lt;2e-16 ***
ORIGIN_GRID2131     18.0985967  0.0044218  4093.08   &lt;2e-16 ***
ORIGIN_GRID2132     17.2608811  0.0058833  2933.89   &lt;2e-16 ***
ORIGIN_GRID2148     16.6990687  0.0108860  1533.99   &lt;2e-16 ***
ORIGIN_GRID2149     15.1805124  0.0153305   990.22   &lt;2e-16 ***
ORIGIN_GRID215      13.8816598  0.0825046   168.25   &lt;2e-16 ***
ORIGIN_GRID2150     17.7046494  0.0044904  3942.80   &lt;2e-16 ***
ORIGIN_GRID2151     18.1813803  0.0035465  5126.50   &lt;2e-16 ***
ORIGIN_GRID2152     18.3464109  0.0038231  4798.82   &lt;2e-16 ***
ORIGIN_GRID2153     17.7323802  0.0055007  3223.69   &lt;2e-16 ***
ORIGIN_GRID216      18.0164532  0.0052863  3408.12   &lt;2e-16 ***
ORIGIN_GRID217      15.3349357  0.0204076   751.43   &lt;2e-16 ***
ORIGIN_GRID2171     16.6684374  0.0069016  2415.17   &lt;2e-16 ***
ORIGIN_GRID2172     16.9926603  0.0076237  2228.92   &lt;2e-16 ***
ORIGIN_GRID2173     17.3089112  0.0051348  3370.93   &lt;2e-16 ***
ORIGIN_GRID2174     17.7042173  0.0051253  3454.28   &lt;2e-16 ***
ORIGIN_GRID2191     16.4174250  0.0098983  1658.62   &lt;2e-16 ***
ORIGIN_GRID2192     16.0856947  0.0106420  1511.52   &lt;2e-16 ***
ORIGIN_GRID2193     17.2015633  0.0058818  2924.55   &lt;2e-16 ***
ORIGIN_GRID2194     17.5262978  0.0050261  3487.07   &lt;2e-16 ***
ORIGIN_GRID2195     17.0467585  0.0198390   859.25   &lt;2e-16 ***
ORIGIN_GRID2212     14.2487095  0.0798364   178.47   &lt;2e-16 ***
ORIGIN_GRID2213     13.7553230  0.0380345   361.65   &lt;2e-16 ***
ORIGIN_GRID2214     15.3208793  0.0240932   635.90   &lt;2e-16 ***
ORIGIN_GRID2215     17.2255628  0.0064628  2665.36   &lt;2e-16 ***
ORIGIN_GRID2216     16.2836701  0.0105273  1546.80   &lt;2e-16 ***
ORIGIN_GRID2233     14.1379895  0.0387086   365.24   &lt;2e-16 ***
ORIGIN_GRID2234     16.2068702  0.0192905   840.15   &lt;2e-16 ***
ORIGIN_GRID2235     16.0757318  0.0127549  1260.36   &lt;2e-16 ***
ORIGIN_GRID2236     16.0571508  0.0125085  1283.70   &lt;2e-16 ***
ORIGIN_GRID2237     13.8944323  0.0534100   260.15   &lt;2e-16 ***
ORIGIN_GRID2256     14.1400147  0.0501641   281.88   &lt;2e-16 ***
ORIGIN_GRID2257     15.6802988  0.0182958   857.04   &lt;2e-16 ***
ORIGIN_GRID2258     15.0719480  0.0174584   863.30   &lt;2e-16 ***
ORIGIN_GRID2259     14.9209858  0.0350617   425.56   &lt;2e-16 ***
ORIGIN_GRID2277     15.2569190  0.0391856   389.35   &lt;2e-16 ***
ORIGIN_GRID2278     16.2654142  0.0148295  1096.83   &lt;2e-16 ***
ORIGIN_GRID2279     15.1913723  0.0189360   802.25   &lt;2e-16 ***
ORIGIN_GRID2280     13.4645197  0.1005230   133.94   &lt;2e-16 ***
ORIGIN_GRID2297     17.5058748  0.0087918  1991.15   &lt;2e-16 ***
ORIGIN_GRID23       14.7353488  0.0985563   149.51   &lt;2e-16 ***
ORIGIN_GRID2300     13.6904304  0.0594778   230.18   &lt;2e-16 ***
ORIGIN_GRID2301     15.4714078  0.0181537   852.25   &lt;2e-16 ***
ORIGIN_GRID2318     15.8209801  0.0181227   872.99   &lt;2e-16 ***
ORIGIN_GRID2319     16.8567852  0.0099582  1692.75   &lt;2e-16 ***
ORIGIN_GRID2322     16.4943214  0.0119377  1381.70   &lt;2e-16 ***
ORIGIN_GRID2337     17.4409609  0.0151381  1152.12   &lt;2e-16 ***
ORIGIN_GRID2341     17.1774272  0.0089280  1923.99   &lt;2e-16 ***
ORIGIN_GRID2343     16.1139986  0.0139209  1157.54   &lt;2e-16 ***
ORIGIN_GRID2361     16.8563406  0.0104372  1615.02   &lt;2e-16 ***
ORIGIN_GRID2364     13.5835290  0.0644483   210.77   &lt;2e-16 ***
ORIGIN_GRID237      12.8114540  0.1561862    82.03   &lt;2e-16 ***
ORIGIN_GRID2379     16.9947468  0.0170602   996.16   &lt;2e-16 ***
ORIGIN_GRID238      13.9275054  0.0510702   272.71   &lt;2e-16 ***
ORIGIN_GRID2384     16.6438257  0.0143627  1158.83   &lt;2e-16 ***
ORIGIN_GRID239      13.0762463  0.1581273    82.69   &lt;2e-16 ***
ORIGIN_GRID2405     16.3790926  0.0142000  1153.46   &lt;2e-16 ***
ORIGIN_GRID2406     14.9611312  0.0331233   451.68   &lt;2e-16 ***
ORIGIN_GRID2426     16.6724253  0.0262550   635.02   &lt;2e-16 ***
ORIGIN_GRID2427     17.3308207  0.0104214  1663.01   &lt;2e-16 ***
ORIGIN_GRID2505     16.6121616  0.0362959   457.69   &lt;2e-16 ***
ORIGIN_GRID257      13.8368143  0.0564677   245.04   &lt;2e-16 ***
ORIGIN_GRID258      14.6221763  0.0271180   539.21   &lt;2e-16 ***
ORIGIN_GRID259      14.4629644  0.0403081   358.81   &lt;2e-16 ***
ORIGIN_GRID278      14.9877687  0.0383410   390.91   &lt;2e-16 ***
ORIGIN_GRID279      13.8486035  0.0428415   323.25   &lt;2e-16 ***
ORIGIN_GRID280      14.1379434  0.0451733   312.97   &lt;2e-16 ***
ORIGIN_GRID298      11.5713658  0.3333389    34.71   &lt;2e-16 ***
ORIGIN_GRID299      13.8484197  0.0496047   279.18   &lt;2e-16 ***
ORIGIN_GRID300      16.8834300  0.0087059  1939.32   &lt;2e-16 ***
ORIGIN_GRID320      13.6663641  0.0636569   214.69   &lt;2e-16 ***
ORIGIN_GRID321      14.3542910  0.0710942   201.91   &lt;2e-16 ***
ORIGIN_GRID322      14.9683124  0.0467228   320.37   &lt;2e-16 ***
ORIGIN_GRID340      15.4941628  0.0272652   568.28   &lt;2e-16 ***
ORIGIN_GRID341      13.7550455  0.0441933   311.25   &lt;2e-16 ***
ORIGIN_GRID342      14.1398866  0.0411465   343.65   &lt;2e-16 ***
ORIGIN_GRID363      14.9760159  0.0369606   405.19   &lt;2e-16 ***
ORIGIN_GRID364      15.1152709  0.0264881   570.64   &lt;2e-16 ***
ORIGIN_GRID383      14.7451978  0.0311768   472.95   &lt;2e-16 ***
ORIGIN_GRID384      13.4906966  0.0520941   258.97   &lt;2e-16 ***
ORIGIN_GRID385      14.5267238  0.0460171   315.68   &lt;2e-16 ***
ORIGIN_GRID404      15.2502248  0.0339763   448.85   &lt;2e-16 ***
ORIGIN_GRID405      14.1661551  0.0486034   291.46   &lt;2e-16 ***
ORIGIN_GRID406      18.9038756  0.0031129  6072.81   &lt;2e-16 ***
ORIGIN_GRID407      14.8443978  0.0453565   327.28   &lt;2e-16 ***
ORIGIN_GRID408      15.6681238  0.0227435   688.90   &lt;2e-16 ***
ORIGIN_GRID425      12.9591994  0.0880651   147.16   &lt;2e-16 ***
ORIGIN_GRID426      14.7151446  0.0294759   499.23   &lt;2e-16 ***
ORIGIN_GRID427      13.9825814  0.0354114   394.86   &lt;2e-16 ***
ORIGIN_GRID428      14.0144894  0.0778778   179.96   &lt;2e-16 ***
ORIGIN_GRID429      15.8504711  0.0225942   701.53   &lt;2e-16 ***
ORIGIN_GRID44       12.6438923  0.1386859    91.17   &lt;2e-16 ***
ORIGIN_GRID446      14.5847461  0.0587554   248.23   &lt;2e-16 ***
ORIGIN_GRID447      14.0085181  0.0444984   314.81   &lt;2e-16 ***
ORIGIN_GRID448      14.7715272  0.0278387   530.61   &lt;2e-16 ***
ORIGIN_GRID449      17.8194255  0.0062529  2849.79   &lt;2e-16 ***
ORIGIN_GRID450      15.6661001  0.0195390   801.79   &lt;2e-16 ***
ORIGIN_GRID46       13.3848600  0.0873927   153.16   &lt;2e-16 ***
ORIGIN_GRID468      14.9832219  0.0276124   542.63   &lt;2e-16 ***
ORIGIN_GRID469      15.5835948  0.0175167   889.64   &lt;2e-16 ***
ORIGIN_GRID470      18.1207420  0.0047166  3841.94   &lt;2e-16 ***
ORIGIN_GRID471      16.4924270  0.0159971  1030.96   &lt;2e-16 ***
ORIGIN_GRID488      14.5747065  0.0573887   253.97   &lt;2e-16 ***
ORIGIN_GRID489      11.8247353  0.2500073    47.30   &lt;2e-16 ***
ORIGIN_GRID490      16.4646805  0.0114942  1432.44   &lt;2e-16 ***
ORIGIN_GRID491      17.0619569  0.0074816  2280.51   &lt;2e-16 ***
ORIGIN_GRID493      12.5709333  0.1386897    90.64   &lt;2e-16 ***
ORIGIN_GRID494      14.6044863  0.0588593   248.12   &lt;2e-16 ***
ORIGIN_GRID509      14.7946614  0.0337460   438.41   &lt;2e-16 ***
ORIGIN_GRID510      15.0775061  0.0246209   612.39   &lt;2e-16 ***
ORIGIN_GRID511      16.1073040  0.0106705  1509.51   &lt;2e-16 ***
ORIGIN_GRID512      18.6299355  0.0035233  5287.70   &lt;2e-16 ***
ORIGIN_GRID513      15.4405909  0.0239834   643.80   &lt;2e-16 ***
ORIGIN_GRID514      15.0328199  0.0367640   408.90   &lt;2e-16 ***
ORIGIN_GRID515      12.8267824  0.1373754    93.37   &lt;2e-16 ***
ORIGIN_GRID530      13.9064571  0.0808687   171.96   &lt;2e-16 ***
ORIGIN_GRID531      15.1884891  0.0201719   752.95   &lt;2e-16 ***
ORIGIN_GRID532      14.7691233  0.0229792   642.72   &lt;2e-16 ***
ORIGIN_GRID533      18.4038225  0.0035638  5164.14   &lt;2e-16 ***
ORIGIN_GRID534      18.8055646  0.0038848  4840.83   &lt;2e-16 ***
ORIGIN_GRID536      15.3471602  0.0250400   612.91   &lt;2e-16 ***
ORIGIN_GRID537      12.9875174  0.1373767    94.54   &lt;2e-16 ***
ORIGIN_GRID538      12.7454138  0.2041356    62.44   &lt;2e-16 ***
ORIGIN_GRID539      10.6456465  0.5773532    18.44   &lt;2e-16 ***
ORIGIN_GRID551      13.9412614  0.0539485   258.42   &lt;2e-16 ***
ORIGIN_GRID552      15.8004008  0.0364691   433.25   &lt;2e-16 ***
ORIGIN_GRID553      14.9344257  0.0189469   788.23   &lt;2e-16 ***
ORIGIN_GRID554      18.3420282  0.0038109  4813.06   &lt;2e-16 ***
ORIGIN_GRID555      17.8472900  0.0068615  2601.08   &lt;2e-16 ***
ORIGIN_GRID559      13.5965884  0.0932723   145.77   &lt;2e-16 ***
ORIGIN_GRID560      15.4608930  0.0473496   326.53   &lt;2e-16 ***
ORIGIN_GRID572      11.6661346  0.2236147    52.17   &lt;2e-16 ***
ORIGIN_GRID573      14.1307242  0.0435182   324.71   &lt;2e-16 ***
ORIGIN_GRID574      14.9492262  0.0360913   414.21   &lt;2e-16 ***
ORIGIN_GRID575      19.2527502  0.0026614  7234.17   &lt;2e-16 ***
ORIGIN_GRID576      17.9181221  0.0049827  3596.04   &lt;2e-16 ***
ORIGIN_GRID578      13.0317758  0.1072297   121.53   &lt;2e-16 ***
ORIGIN_GRID582      13.2235687  0.1066176   124.03   &lt;2e-16 ***
ORIGIN_GRID583      12.4179423  0.1961257    63.32   &lt;2e-16 ***
ORIGIN_GRID584      15.6313057  0.0550961   283.71   &lt;2e-16 ***
ORIGIN_GRID593      14.3484782  0.0494887   289.94   &lt;2e-16 ***
ORIGIN_GRID594      15.1511498  0.0258632   585.82   &lt;2e-16 ***
ORIGIN_GRID595      14.7142649  0.0197750   744.08   &lt;2e-16 ***
ORIGIN_GRID596      17.7240118  0.0044369  3994.67   &lt;2e-16 ***
ORIGIN_GRID597      14.5703545  0.0588600   247.54   &lt;2e-16 ***
ORIGIN_GRID603      13.5174593  0.1084840   124.60   &lt;2e-16 ***
ORIGIN_GRID604      11.7991844  0.2672682    44.15   &lt;2e-16 ***
ORIGIN_GRID615      13.7763935  0.0438958   313.84   &lt;2e-16 ***
ORIGIN_GRID616      14.6826594  0.0290176   505.99   &lt;2e-16 ***
ORIGIN_GRID617      15.3706593  0.0173789   884.44   &lt;2e-16 ***
ORIGIN_GRID618      18.2390721  0.0039671  4597.60   &lt;2e-16 ***
ORIGIN_GRID620      15.0725384  0.0323761   465.55   &lt;2e-16 ***
ORIGIN_GRID637      14.0447253  0.0392108   358.19   &lt;2e-16 ***
ORIGIN_GRID638      17.8024617  0.0042861  4153.50   &lt;2e-16 ***
ORIGIN_GRID657      15.6501590  0.0161613   968.37   &lt;2e-16 ***
ORIGIN_GRID658      17.0258196  0.0064168  2653.34   &lt;2e-16 ***
ORIGIN_GRID659      17.3936424  0.0054694  3180.15   &lt;2e-16 ***
ORIGIN_GRID66       13.4972271  0.1250136   107.97   &lt;2e-16 ***
ORIGIN_GRID660      18.4397483  0.0035004  5267.85   &lt;2e-16 ***
ORIGIN_GRID662      17.9237742  0.0071766  2497.51   &lt;2e-16 ***
ORIGIN_GRID67       15.4524294  0.0248962   620.67   &lt;2e-16 ***
ORIGIN_GRID677      15.7029639  0.0223999   701.03   &lt;2e-16 ***
ORIGIN_GRID678      13.6274896  0.0436069   312.51   &lt;2e-16 ***
ORIGIN_GRID679      18.2348015  0.0037844  4818.36   &lt;2e-16 ***
ORIGIN_GRID68       12.5490224  0.1291138    97.19   &lt;2e-16 ***
ORIGIN_GRID680      18.3070052  0.0037577  4871.89   &lt;2e-16 ***
ORIGIN_GRID681      17.3102434  0.0084198  2055.89   &lt;2e-16 ***
ORIGIN_GRID699      15.2027278  0.0220183   690.46   &lt;2e-16 ***
ORIGIN_GRID700      17.1848476  0.0061522  2793.26   &lt;2e-16 ***
ORIGIN_GRID701      17.3026344  0.0062022  2789.75   &lt;2e-16 ***
ORIGIN_GRID702      18.2439262  0.0036971  4934.66   &lt;2e-16 ***
ORIGIN_GRID704      14.8997522  0.0319279   466.67   &lt;2e-16 ***
ORIGIN_GRID722      15.1603249  0.0178808   847.85   &lt;2e-16 ***
ORIGIN_GRID725      14.1873432  0.0435670   325.64   &lt;2e-16 ***
ORIGIN_GRID741      15.7529055  0.0163135   965.63   &lt;2e-16 ***
ORIGIN_GRID743      15.6222803  0.0123179  1268.26   &lt;2e-16 ***
ORIGIN_GRID744      17.6813516  0.0046145  3831.70   &lt;2e-16 ***
ORIGIN_GRID761      15.2096074  0.0271195   560.84   &lt;2e-16 ***
ORIGIN_GRID762      17.2370878  0.0070477  2445.76   &lt;2e-16 ***
ORIGIN_GRID763      14.0772501  0.0275969   510.10   &lt;2e-16 ***
ORIGIN_GRID764      18.1386099  0.0036549  4962.84   &lt;2e-16 ***
ORIGIN_GRID765      17.1135211  0.0081856  2090.70   &lt;2e-16 ***
ORIGIN_GRID767      18.6843015  0.0038740  4823.03   &lt;2e-16 ***
ORIGIN_GRID772      13.6449618  0.0720099   189.49   &lt;2e-16 ***
ORIGIN_GRID784      14.3155694  0.0234667   610.04   &lt;2e-16 ***
ORIGIN_GRID785      17.3369538  0.0044942  3857.60   &lt;2e-16 ***
ORIGIN_GRID786      16.9239532  0.0060856  2781.00   &lt;2e-16 ***
ORIGIN_GRID787      17.4792072  0.0072447  2412.69   &lt;2e-16 ***
ORIGIN_GRID788      18.0152157  0.0053478  3368.72   &lt;2e-16 ***
ORIGIN_GRID789      16.4653059  0.0104173  1580.57   &lt;2e-16 ***
ORIGIN_GRID803      13.8363273  0.0487772   283.66   &lt;2e-16 ***
ORIGIN_GRID804      18.1755880  0.0042805  4246.16   &lt;2e-16 ***
ORIGIN_GRID805      17.9840545  0.0036541  4921.66   &lt;2e-16 ***
ORIGIN_GRID806      17.5156949  0.0044614  3926.02   &lt;2e-16 ***
ORIGIN_GRID807      18.3120808  0.0043744  4186.23   &lt;2e-16 ***
ORIGIN_GRID808      16.7123301  0.0109001  1533.23   &lt;2e-16 ***
ORIGIN_GRID809      18.2137539  0.0036832  4945.13   &lt;2e-16 ***
ORIGIN_GRID810      17.5103312  0.0055787  3138.78   &lt;2e-16 ***
ORIGIN_GRID814      15.1911703  0.0275099   552.21   &lt;2e-16 ***
ORIGIN_GRID824      14.4124354  0.0383421   375.89   &lt;2e-16 ***
ORIGIN_GRID826      15.7400752  0.0100174  1571.27   &lt;2e-16 ***
ORIGIN_GRID827      17.7913037  0.0039961  4452.22   &lt;2e-16 ***
ORIGIN_GRID828      17.8880223  0.0039057  4579.98   &lt;2e-16 ***
ORIGIN_GRID829      17.9241447  0.0046599  3846.48   &lt;2e-16 ***
ORIGIN_GRID830      17.8807106  0.0051976  3440.15   &lt;2e-16 ***
ORIGIN_GRID831      18.7184265  0.0032160  5820.39   &lt;2e-16 ***
ORIGIN_GRID832      17.8889460  0.0060932  2935.90   &lt;2e-16 ***
ORIGIN_GRID835      14.8551107  0.0292614   507.67   &lt;2e-16 ***
ORIGIN_GRID844      13.2407774  0.0778753   170.03   &lt;2e-16 ***
ORIGIN_GRID846      17.2977490  0.0053222  3250.11   &lt;2e-16 ***
ORIGIN_GRID847      16.1483811  0.0089220  1809.94   &lt;2e-16 ***
ORIGIN_GRID848      17.3383017  0.0048938  3542.89   &lt;2e-16 ***
ORIGIN_GRID849      16.4721326  0.0078272  2104.47   &lt;2e-16 ***
ORIGIN_GRID850      17.3361870  0.0054917  3156.80   &lt;2e-16 ***
ORIGIN_GRID851      17.6867595  0.0042910  4121.79   &lt;2e-16 ***
ORIGIN_GRID852      17.1392389  0.0060479  2833.91   &lt;2e-16 ***
ORIGIN_GRID853      18.9954727  0.0037958  5004.38   &lt;2e-16 ***
ORIGIN_GRID854      15.2608808  0.0258514   590.33   &lt;2e-16 ***
ORIGIN_GRID855      14.1959924  0.0434398   326.80   &lt;2e-16 ***
ORIGIN_GRID856      15.8437589  0.0179559   882.37   &lt;2e-16 ***
ORIGIN_GRID86       14.2106109  0.0735466   193.22   &lt;2e-16 ***
ORIGIN_GRID866      14.8114887  0.0317964   465.82   &lt;2e-16 ***
ORIGIN_GRID867      16.0512116  0.0118416  1355.49   &lt;2e-16 ***
ORIGIN_GRID868      15.2208724  0.0176508   862.34   &lt;2e-16 ***
ORIGIN_GRID869      17.8614795  0.0058539  3051.20   &lt;2e-16 ***
ORIGIN_GRID87       14.2433792  0.0811356   175.55   &lt;2e-16 ***
ORIGIN_GRID870      18.3978302  0.0032641  5636.46   &lt;2e-16 ***
ORIGIN_GRID871      17.9578783  0.0058629  3062.97   &lt;2e-16 ***
ORIGIN_GRID872      15.9749105  0.0108401  1473.68   &lt;2e-16 ***
ORIGIN_GRID873      16.0922952  0.0100474  1601.64   &lt;2e-16 ***
ORIGIN_GRID874      16.4815888  0.0080686  2042.69   &lt;2e-16 ***
ORIGIN_GRID875      13.4028816  0.0720080   186.13   &lt;2e-16 ***
ORIGIN_GRID876      14.4843023  0.0314779   460.14   &lt;2e-16 ***
ORIGIN_GRID877      13.9270026  0.0400431   347.80   &lt;2e-16 ***
ORIGIN_GRID88       16.0084783  0.0186078   860.31   &lt;2e-16 ***
ORIGIN_GRID887      15.7716600  0.0133614  1180.39   &lt;2e-16 ***
ORIGIN_GRID888      17.0455197  0.0068996  2470.52   &lt;2e-16 ***
ORIGIN_GRID889      13.9937591  0.0338641   413.23   &lt;2e-16 ***
ORIGIN_GRID89       14.2420056  0.0496065   287.10   &lt;2e-16 ***
ORIGIN_GRID890      17.9410506  0.0038575  4650.90   &lt;2e-16 ***
ORIGIN_GRID891      16.6604338  0.0111579  1493.15   &lt;2e-16 ***
ORIGIN_GRID893      17.7566331  0.0040812  4350.80   &lt;2e-16 ***
ORIGIN_GRID894      15.9004108  0.0108729  1462.39   &lt;2e-16 ***
ORIGIN_GRID895      15.6038446  0.0151278  1031.47   &lt;2e-16 ***
ORIGIN_GRID896      15.1088889  0.0253155   596.82   &lt;2e-16 ***
ORIGIN_GRID897      13.1723349  0.0639149   206.09   &lt;2e-16 ***
ORIGIN_GRID898      15.0137383  0.0290658   516.54   &lt;2e-16 ***
ORIGIN_GRID90       13.1206542  0.1324672    99.05   &lt;2e-16 ***
ORIGIN_GRID908      16.9860669  0.0118753  1430.37   &lt;2e-16 ***
ORIGIN_GRID909      17.1052739  0.0056870  3007.78   &lt;2e-16 ***
ORIGIN_GRID910      15.0606026  0.0171523   878.05   &lt;2e-16 ***
ORIGIN_GRID911      16.3725628  0.0086134  1900.83   &lt;2e-16 ***
ORIGIN_GRID912      17.6382292  0.0043931  4015.01   &lt;2e-16 ***
ORIGIN_GRID915      17.6703100  0.0043753  4038.69   &lt;2e-16 ***
ORIGIN_GRID917      17.1977708  0.0072619  2368.21   &lt;2e-16 ***
ORIGIN_GRID918      14.0752154  0.0361132   389.75   &lt;2e-16 ***
ORIGIN_GRID919      16.6117326  0.0089054  1865.36   &lt;2e-16 ***
ORIGIN_GRID928      16.1996525  0.0133190  1216.28   &lt;2e-16 ***
ORIGIN_GRID929      17.5132755  0.0046013  3806.12   &lt;2e-16 ***
ORIGIN_GRID930      18.2278455  0.0032664  5580.47   &lt;2e-16 ***
ORIGIN_GRID931      15.2496427  0.0165475   921.57   &lt;2e-16 ***
ORIGIN_GRID932      15.7926525  0.0173746   908.95   &lt;2e-16 ***
ORIGIN_GRID933      17.4489252  0.0055743  3130.24   &lt;2e-16 ***
ORIGIN_GRID934      15.0072487  0.0171254   876.31   &lt;2e-16 ***
ORIGIN_GRID935      18.5528314  0.0032817  5653.35   &lt;2e-16 ***
ORIGIN_GRID938      12.0151091  0.2132096    56.35   &lt;2e-16 ***
ORIGIN_GRID939      18.5741532  0.0038258  4855.01   &lt;2e-16 ***
ORIGIN_GRID940      13.7052055  0.0604419   226.75   &lt;2e-16 ***
ORIGIN_GRID949      15.9957383  0.0125660  1272.93   &lt;2e-16 ***
ORIGIN_GRID950      17.9521421  0.0048654  3689.79   &lt;2e-16 ***
ORIGIN_GRID951      18.7360218  0.0029565  6337.24   &lt;2e-16 ***
ORIGIN_GRID952      15.6142114  0.0208578   748.60   &lt;2e-16 ***
ORIGIN_GRID953      16.5637781  0.0093053  1780.04   &lt;2e-16 ***
ORIGIN_GRID954      15.0738600  0.0165481   910.91   &lt;2e-16 ***
ORIGIN_GRID955      17.2409915  0.0056289  3062.93   &lt;2e-16 ***
ORIGIN_GRID956      15.6490612  0.0113032  1384.48   &lt;2e-16 ***
ORIGIN_GRID957      17.5693232  0.0055220  3181.71   &lt;2e-16 ***
ORIGIN_GRID959      14.5110464  0.0483744   299.97   &lt;2e-16 ***
ORIGIN_GRID961      14.2384711  0.0297567   478.50   &lt;2e-16 ***
ORIGIN_GRID962       9.4304732  1.0000021     9.43   &lt;2e-16 ***
ORIGIN_GRID970      16.5031086  0.0078734  2096.07   &lt;2e-16 ***
ORIGIN_GRID971      17.7009945  0.0039014  4537.10   &lt;2e-16 ***
ORIGIN_GRID972      17.4568865  0.0047582  3668.77   &lt;2e-16 ***
ORIGIN_GRID974      16.8302330  0.0072588  2318.59   &lt;2e-16 ***
ORIGIN_GRID975      16.3842910  0.0087743  1867.31   &lt;2e-16 ***
ORIGIN_GRID976      15.0240081  0.0166568   901.97   &lt;2e-16 ***
ORIGIN_GRID977      18.0648750  0.0037849  4772.87   &lt;2e-16 ***
ORIGIN_GRID978      17.6615067  0.0068391  2582.43   &lt;2e-16 ***
ORIGIN_GRID982      15.5366974  0.0142427  1090.86   &lt;2e-16 ***
ORIGIN_GRID983      19.6905959  0.0037141  5301.61   &lt;2e-16 ***
ORIGIN_GRID991      16.3995392  0.0087605  1871.98   &lt;2e-16 ***
ORIGIN_GRID992      16.7904736  0.0067928  2471.79   &lt;2e-16 ***
ORIGIN_GRID993      16.4143841  0.0073124  2244.75   &lt;2e-16 ***
ORIGIN_GRID994      15.8314417  0.0107979  1466.15   &lt;2e-16 ***
ORIGIN_GRID995      17.2389738  0.0055173  3124.54   &lt;2e-16 ***
ORIGIN_GRID996      16.7611182  0.0074475  2250.58   &lt;2e-16 ***
ORIGIN_GRID997      15.2071366  0.0290729   523.07   &lt;2e-16 ***
ORIGIN_GRID998      18.1832380  0.0039572  4595.01   &lt;2e-16 ***
ORIGIN_GRID999      18.0512004  0.0053533  3371.97   &lt;2e-16 ***
log(BIZ_COUNT)       0.1135992  0.0001966   577.77   &lt;2e-16 ***
log(SCHOOL_COUNT)    0.2354748  0.0006910   340.76   &lt;2e-16 ***
log(FIN_COUNT)       0.3594333  0.0002843  1264.09   &lt;2e-16 ***
log(FNB_COUNT)      -0.1430508  0.0003087  -463.33   &lt;2e-16 ***
log(ent_COUNT)      -0.1428803  0.0008529  -167.52   &lt;2e-16 ***
log(stn_exit_COUNT)  0.5126272  0.0003977  1289.07   &lt;2e-16 ***
log(HDB_COUNT)      -0.0258295  0.0001707  -151.33   &lt;2e-16 ***
log(lnr_COUNT)      -0.1393890  0.0004081  -341.53   &lt;2e-16 ***
log(DIST)           -1.5044686  0.0002662 -5651.18   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 336170273  on 65111  degrees of freedom
Residual deviance:  34744414  on 64288  degrees of freedom
AIC: 35104136

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<section id="goodness-of-fit" class="level2">
<h2 class="anchored" data-anchor-id="goodness-of-fit">Goodness-of-fit</h2>
<p>Goodness-of-fit refers to how well sample data is able to fit the curve. To calculate that we will first have to create our own R-squared function.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, estimated){</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span><span class="fu">cor</span>(observed, estimated)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  R2<span class="ot">&lt;-</span>r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After that we can then apply the function to our data from the Origin constrained model.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4099705</code></pre>
</div>
</div>
<p>This shows that about 41% of our variation in our data. This means that there can be further improvement and we can try using other modeling techniques.</p>
<p>To compare with other models, we can use the Root-mean-square deviation(RMSE). We can do that using <strong>performance</strong> package.</p>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance_rmse</span>(orcSIM_Poisson, <span class="at">normalized =</span> <span class="cn">FALSE</span>)  <span class="co">#normalized will set mean to 0 like a z distrib</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1376.429</code></pre>
</div>
</div>
<p>Here we obtain a value of about 1376, a smaller value represents increase accuracy.</p>
</section>
</section>
<section id="doubly-constrained-model" class="level1">
<h1>Doubly constrained model</h1>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>dbcSIM_Poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS<span class="sc">~</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>                        ORIGIN_GRID <span class="sc">+</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>                        DESTIN_GRID <span class="sc">+</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(DIST), <span class="co"># no -1 cus no attractiveness btw origin and des</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.action =</span> na.exclude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="goodness-of-fit-1" class="level2">
<h2 class="anchored" data-anchor-id="goodness-of-fit-1">Goodness-of-fit</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM_Poisson<span class="sc">$</span>data<span class="sc">$</span>TRIPS, dbcSIM_Poisson<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5752984</code></pre>
</div>
</div>
</section>
</section>
<section id="unconstrained-model" class="level1">
<h1>Unconstrained model</h1>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">log</span>(BIZ_COUNT)<span class="sc">+</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(SCHOOL_COUNT) <span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(FIN_COUNT)<span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(FNB_COUNT)<span class="sc">+</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(ent_COUNT)<span class="sc">+</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(stn_exit_COUNT)<span class="sc">+</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(HDB_COUNT)<span class="sc">+</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(lnr_COUNT)<span class="sc">+</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DIST),</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(BIZ_COUNT) + log(SCHOOL_COUNT) + log(FIN_COUNT) + 
    log(FNB_COUNT) + log(ent_COUNT) + log(stn_exit_COUNT) + log(HDB_COUNT) + 
    log(lnr_COUNT) + log(DIST), family = poisson(link = "log"), 
    data = inter_zonal_flow, na.action = na.exclude)

Coefficients:
        (Intercept)       log(BIZ_COUNT)    log(SCHOOL_COUNT)  
           16.74859              0.07485              0.29868  
     log(FIN_COUNT)       log(FNB_COUNT)       log(ent_COUNT)  
            0.30419             -0.18460             -0.06279  
log(stn_exit_COUNT)       log(HDB_COUNT)       log(lnr_COUNT)  
            0.47681              0.08313             -0.20245  
          log(DIST)  
           -1.44691  

Degrees of Freedom: 65110 Total (i.e. Null);  65101 Residual
Null Deviance:      97210000 
Residual Deviance: 54480000     AIC: 54840000</code></pre>
</div>
</div>
<section id="goodness-of-fit-2" class="level2">
<h2 class="anchored" data-anchor-id="goodness-of-fit-2">Goodness-of-fit</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2165996</code></pre>
</div>
</div>
</section>
</section>
<section id="destination-constrained-model" class="level1">
<h1>Destination constrained model</h1>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                DESTIN_GRID <span class="sc">+</span> <span class="fu">log</span>(SCHOOL_COUNT) <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(FIN_COUNT)<span class="sc">+</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(FNB_COUNT)<span class="sc">+</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(ent_COUNT)<span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(stn_exit_COUNT)<span class="sc">+</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(HDB_COUNT)<span class="sc">+</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(lnr_COUNT)<span class="sc">+</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DIST),</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ DESTIN_GRID + log(SCHOOL_COUNT) + log(FIN_COUNT) + 
    log(FNB_COUNT) + log(ent_COUNT) + log(stn_exit_COUNT) + log(HDB_COUNT) + 
    log(lnr_COUNT) + log(DIST), family = poisson(link = "log"), 
    data = inter_zonal_flow, na.action = na.exclude)

Coefficients: (7 not defined because of singularities)
                      Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)         16.3363526  0.0154561  1056.953  &lt; 2e-16 ***
DESTIN_GRID1003      2.3950026  0.0155879   153.645  &lt; 2e-16 ***
DESTIN_GRID1004      1.6564964  0.0159516   103.845  &lt; 2e-16 ***
DESTIN_GRID1011      0.3314848  0.0193142    17.163  &lt; 2e-16 ***
DESTIN_GRID1012      1.8209092  0.0163345   111.476  &lt; 2e-16 ***
DESTIN_GRID1013      0.7038657  0.0169943    41.418  &lt; 2e-16 ***
DESTIN_GRID1014     -1.0797210  0.0219165   -49.265  &lt; 2e-16 ***
DESTIN_GRID1015      1.6573412  0.0158261   104.722  &lt; 2e-16 ***
DESTIN_GRID1016      1.8902465  0.0157221   120.228  &lt; 2e-16 ***
DESTIN_GRID1018      0.3465122  0.0194041    17.858  &lt; 2e-16 ***
DESTIN_GRID1019      1.4779582  0.0162946    90.703  &lt; 2e-16 ***
DESTIN_GRID1023      0.4201189  0.0200085    20.997  &lt; 2e-16 ***
DESTIN_GRID1024      1.2499650  0.0165261    75.636  &lt; 2e-16 ***
DESTIN_GRID1025     -2.8903248  0.0663473   -43.564  &lt; 2e-16 ***
DESTIN_GRID1033      0.8880742  0.0166503    53.337  &lt; 2e-16 ***
DESTIN_GRID1034      1.5395181  0.0159098    96.765  &lt; 2e-16 ***
DESTIN_GRID1035      1.3734111  0.0159740    85.978  &lt; 2e-16 ***
DESTIN_GRID1036      1.8066092  0.0157403   114.776  &lt; 2e-16 ***
DESTIN_GRID1037      0.6475249  0.0163971    39.490  &lt; 2e-16 ***
DESTIN_GRID1043      0.6170147  0.0186690    33.050  &lt; 2e-16 ***
DESTIN_GRID1045      1.0901920  0.0163051    66.862  &lt; 2e-16 ***
DESTIN_GRID1046      1.4259427  0.0162635    87.678  &lt; 2e-16 ***
DESTIN_GRID1053      1.4700374  0.0159711    92.043  &lt; 2e-16 ***
DESTIN_GRID1054      1.2559936  0.0160330    78.338  &lt; 2e-16 ***
DESTIN_GRID1055      0.4165579  0.0172078    24.208  &lt; 2e-16 ***
DESTIN_GRID1056     -0.3632129  0.0187457   -19.376  &lt; 2e-16 ***
DESTIN_GRID1064     -2.3824641  0.0883802   -26.957  &lt; 2e-16 ***
DESTIN_GRID1066      2.4073938  0.0157501   152.849  &lt; 2e-16 ***
DESTIN_GRID1067      1.6798885  0.0165182   101.700  &lt; 2e-16 ***
DESTIN_GRID1074     -0.6047564  0.0203360   -29.738  &lt; 2e-16 ***
DESTIN_GRID1075      1.0302428  0.0163842    62.880  &lt; 2e-16 ***
DESTIN_GRID1076      0.4461089  0.0166531    26.788  &lt; 2e-16 ***
DESTIN_GRID1077     -0.2634034  0.0183084   -14.387  &lt; 2e-16 ***
DESTIN_GRID1079      1.0021117  0.0163185    61.410  &lt; 2e-16 ***
DESTIN_GRID1085     -0.4625420  0.0582233    -7.944 1.95e-15 ***
DESTIN_GRID1087      1.5027317  0.0163775    91.756  &lt; 2e-16 ***
DESTIN_GRID1088      1.8647939  0.0161638   115.369  &lt; 2e-16 ***
DESTIN_GRID109      -0.1986450  0.0295891    -6.713 1.90e-11 ***
DESTIN_GRID1094     -2.3837452  0.0504986   -47.204  &lt; 2e-16 ***
DESTIN_GRID1095      0.2120473  0.0202343    10.480  &lt; 2e-16 ***
DESTIN_GRID1096      0.1836715  0.0211777     8.673  &lt; 2e-16 ***
DESTIN_GRID1097      1.3541694  0.0158263    85.564  &lt; 2e-16 ***
DESTIN_GRID1098     -1.2707462  0.0264084   -48.119  &lt; 2e-16 ***
DESTIN_GRID1099      0.3214213  0.0170622    18.838  &lt; 2e-16 ***
DESTIN_GRID110      -2.5558016  0.1016675   -25.139  &lt; 2e-16 ***
DESTIN_GRID1105      1.3408371  0.0175254    76.508  &lt; 2e-16 ***
DESTIN_GRID1106     -2.3128473  0.0861949   -26.833  &lt; 2e-16 ***
DESTIN_GRID1107      1.6420745  0.0169118    97.096  &lt; 2e-16 ***
DESTIN_GRID1108      3.3936291  0.0154146   220.157  &lt; 2e-16 ***
DESTIN_GRID1109     -0.6332413  0.0258314   -24.514  &lt; 2e-16 ***
DESTIN_GRID111       0.6745277  0.0189347    35.624  &lt; 2e-16 ***
DESTIN_GRID1116      0.3839543  0.0174847    21.959  &lt; 2e-16 ***
DESTIN_GRID1117      0.8791284  0.0167137    52.599  &lt; 2e-16 ***
DESTIN_GRID1118     -0.7293932  0.0232397   -31.386  &lt; 2e-16 ***
DESTIN_GRID1119     -0.2349178  0.0183368   -12.811  &lt; 2e-16 ***
DESTIN_GRID112      -1.3673368  0.0336715   -40.608  &lt; 2e-16 ***
DESTIN_GRID1120     -0.8083497  0.0225125   -35.907  &lt; 2e-16 ***
DESTIN_GRID1129      0.9821349  0.0170757    57.517  &lt; 2e-16 ***
DESTIN_GRID1130      1.4874971  0.0162050    91.792  &lt; 2e-16 ***
DESTIN_GRID1131      2.3051389  0.0160682   143.459  &lt; 2e-16 ***
DESTIN_GRID1136      1.6976883  0.0159592   106.377  &lt; 2e-16 ***
DESTIN_GRID1138     -0.4915230  0.0225257   -21.821  &lt; 2e-16 ***
DESTIN_GRID1139      0.2906168  0.0167249    17.376  &lt; 2e-16 ***
DESTIN_GRID1141      0.3256190  0.0170252    19.126  &lt; 2e-16 ***
DESTIN_GRID1148     -0.7991811  0.0329271   -24.271  &lt; 2e-16 ***
DESTIN_GRID1149      0.7876021  0.0200961    39.192  &lt; 2e-16 ***
DESTIN_GRID1150      0.9558890  0.0166016    57.578  &lt; 2e-16 ***
DESTIN_GRID1151      1.1988815  0.0165359    72.502  &lt; 2e-16 ***
DESTIN_GRID1158     -0.3258374  0.0184143   -17.695  &lt; 2e-16 ***
DESTIN_GRID1159     -0.0273650  0.0175254    -1.561 0.118419    
DESTIN_GRID1160      1.4764352  0.0158066    93.406  &lt; 2e-16 ***
DESTIN_GRID1171      1.6698278  0.0162882   102.518  &lt; 2e-16 ***
DESTIN_GRID1172      2.9028758  0.0155323   186.893  &lt; 2e-16 ***
DESTIN_GRID1173      1.7674477  0.0160350   110.224  &lt; 2e-16 ***
DESTIN_GRID1174     -1.4906127  0.0441320   -33.776  &lt; 2e-16 ***
DESTIN_GRID1178      1.9330512  0.0156774   123.302  &lt; 2e-16 ***
DESTIN_GRID1179      0.9321812  0.0160885    57.941  &lt; 2e-16 ***
DESTIN_GRID1180      1.0018490  0.0160074    62.587  &lt; 2e-16 ***
DESTIN_GRID1181     -0.0979239  0.0176185    -5.558 2.73e-08 ***
DESTIN_GRID1183      1.4779837  0.0159770    92.507  &lt; 2e-16 ***
DESTIN_GRID1190     -0.3377438  0.0324497   -10.408  &lt; 2e-16 ***
DESTIN_GRID1192      1.8168374  0.0161213   112.698  &lt; 2e-16 ***
DESTIN_GRID1193      1.4028516  0.0161356    86.942  &lt; 2e-16 ***
DESTIN_GRID1194      1.3765372  0.0163667    84.106  &lt; 2e-16 ***
DESTIN_GRID1200      0.6506759  0.0167427    38.863  &lt; 2e-16 ***
DESTIN_GRID1201      0.3912836  0.0168740    23.189  &lt; 2e-16 ***
DESTIN_GRID1203      0.3248339  0.0170671    19.033  &lt; 2e-16 ***
DESTIN_GRID1204      0.1222261  0.0175468     6.966 3.27e-12 ***
DESTIN_GRID1211     -5.0054290  0.2777739   -18.020  &lt; 2e-16 ***
DESTIN_GRID1214      0.5515826  0.0174048    31.691  &lt; 2e-16 ***
DESTIN_GRID1215      0.9435605  0.0187189    50.407  &lt; 2e-16 ***
DESTIN_GRID1216      0.9394672  0.0181908    51.645  &lt; 2e-16 ***
DESTIN_GRID1220      0.7607951  0.0163874    46.426  &lt; 2e-16 ***
DESTIN_GRID1221      1.4298695  0.0158048    90.470  &lt; 2e-16 ***
DESTIN_GRID1222      0.4604713  0.0195390    23.567  &lt; 2e-16 ***
DESTIN_GRID1223     -0.2193525  0.0188043   -11.665  &lt; 2e-16 ***
DESTIN_GRID1224      0.2836966  0.0171199    16.571  &lt; 2e-16 ***
DESTIN_GRID1231     -1.8217898  0.0591884   -30.780  &lt; 2e-16 ***
DESTIN_GRID1232      0.4562230  0.0287642    15.861  &lt; 2e-16 ***
DESTIN_GRID1235      1.4254680  0.0163258    87.314  &lt; 2e-16 ***
DESTIN_GRID1236      0.7511191  0.0172800    43.468  &lt; 2e-16 ***
DESTIN_GRID1241     -0.3329697  0.0190968   -17.436  &lt; 2e-16 ***
DESTIN_GRID1242      0.0342500  0.0176331     1.942 0.052092 .  
DESTIN_GRID1243      1.0462870  0.0160821    65.059  &lt; 2e-16 ***
DESTIN_GRID1246     -0.0020529  0.0173962    -0.118 0.906063    
DESTIN_GRID1256      0.6351142  0.0174290    36.440  &lt; 2e-16 ***
DESTIN_GRID1257      1.4985466  0.0164177    91.276  &lt; 2e-16 ***
DESTIN_GRID1258      1.8327802  0.0161112   113.758  &lt; 2e-16 ***
DESTIN_GRID1262     -0.4495224  0.0196998   -22.819  &lt; 2e-16 ***
DESTIN_GRID1263      1.6924567  0.0156602   108.074  &lt; 2e-16 ***
DESTIN_GRID1264      0.7458966  0.0169239    44.074  &lt; 2e-16 ***
DESTIN_GRID1265      0.5383329  0.0170675    31.541  &lt; 2e-16 ***
DESTIN_GRID1266      0.8002532  0.0166540    48.052  &lt; 2e-16 ***
DESTIN_GRID1267     -0.6905258  0.0220827   -31.270  &lt; 2e-16 ***
DESTIN_GRID1272     -3.6355953  0.1114918   -32.609  &lt; 2e-16 ***
DESTIN_GRID1273      0.9722528  0.0168164    57.816  &lt; 2e-16 ***
DESTIN_GRID1277      1.7223166  0.0158747   108.495  &lt; 2e-16 ***
DESTIN_GRID1278      1.0888711  0.0164188    66.318  &lt; 2e-16 ***
DESTIN_GRID128      -0.0309088  0.0267897    -1.154 0.248599    
DESTIN_GRID1283      2.0413495  0.0156522   130.420  &lt; 2e-16 ***
DESTIN_GRID1284      1.7414919  0.0157428   110.621  &lt; 2e-16 ***
DESTIN_GRID1285      1.2509548  0.0159095    78.629  &lt; 2e-16 ***
DESTIN_GRID1286      0.2175308  0.0180296    12.065  &lt; 2e-16 ***
DESTIN_GRID1289     -2.1444241  0.0401350   -53.430  &lt; 2e-16 ***
DESTIN_GRID129      -3.0287928  0.1135476   -26.674  &lt; 2e-16 ***
DESTIN_GRID1293     -3.2404236  0.0752999   -43.034  &lt; 2e-16 ***
DESTIN_GRID1294      0.7345351  0.0174554    42.081  &lt; 2e-16 ***
DESTIN_GRID1295     -1.0692050  0.0269395   -39.689  &lt; 2e-16 ***
DESTIN_GRID1298      0.8996671  0.0167339    53.763  &lt; 2e-16 ***
DESTIN_GRID1299      0.6811333  0.0175834    38.737  &lt; 2e-16 ***
DESTIN_GRID130      -0.3772886  0.0266061   -14.181  &lt; 2e-16 ***
DESTIN_GRID1304      0.9477176  0.0163328    58.026  &lt; 2e-16 ***
DESTIN_GRID1305      1.2251036  0.0158430    77.328  &lt; 2e-16 ***
DESTIN_GRID1307     -0.4279902  0.0245005   -17.469  &lt; 2e-16 ***
DESTIN_GRID1308      0.9001785  0.0161944    55.586  &lt; 2e-16 ***
DESTIN_GRID131      -0.9252425  0.0287457   -32.187  &lt; 2e-16 ***
DESTIN_GRID1310     -4.1519437  0.1896038   -21.898  &lt; 2e-16 ***
DESTIN_GRID1316     -0.5020303  0.0218732   -22.952  &lt; 2e-16 ***
DESTIN_GRID1317     -0.4277161  0.0200741   -21.307  &lt; 2e-16 ***
DESTIN_GRID1318     -0.6428104  0.0219083   -29.341  &lt; 2e-16 ***
DESTIN_GRID1319      2.1921576  0.0156519   140.057  &lt; 2e-16 ***
DESTIN_GRID132       0.2899055  0.0212225    13.660  &lt; 2e-16 ***
DESTIN_GRID1320     -0.1915954  0.0203010    -9.438  &lt; 2e-16 ***
DESTIN_GRID1324      1.0077395  0.0217490    46.335  &lt; 2e-16 ***
DESTIN_GRID1325     -0.6833838  0.0207892   -32.872  &lt; 2e-16 ***
DESTIN_GRID1326      0.8175787  0.0162287    50.379  &lt; 2e-16 ***
DESTIN_GRID1327      0.9871385  0.0161274    61.209  &lt; 2e-16 ***
DESTIN_GRID1328      0.5175068  0.0165435    31.282  &lt; 2e-16 ***
DESTIN_GRID1329      0.4444090  0.0174738    25.433  &lt; 2e-16 ***
DESTIN_GRID133       0.0659474  0.0196059     3.364 0.000769 ***
DESTIN_GRID1330      1.9954078  0.0161029   123.916  &lt; 2e-16 ***
DESTIN_GRID1331     -4.2892090  0.2586541   -16.583  &lt; 2e-16 ***
DESTIN_GRID1333     -0.7043322  0.0219444   -32.096  &lt; 2e-16 ***
DESTIN_GRID1334     -0.1806451  0.0198984    -9.078  &lt; 2e-16 ***
DESTIN_GRID1335      1.6250768  0.0162165   100.212  &lt; 2e-16 ***
DESTIN_GRID1336     -1.9734948  0.0578841   -34.094  &lt; 2e-16 ***
DESTIN_GRID1337     -1.5534512  0.0330486   -47.005  &lt; 2e-16 ***
DESTIN_GRID1338     -1.4782533  0.0306274   -48.266  &lt; 2e-16 ***
DESTIN_GRID1339      1.9201437  0.0157281   122.083  &lt; 2e-16 ***
DESTIN_GRID134       0.2334940  0.0191863    12.170  &lt; 2e-16 ***
DESTIN_GRID1340      0.4935035  0.0177605    27.787  &lt; 2e-16 ***
DESTIN_GRID1341     -3.1093394  0.0974400   -31.910  &lt; 2e-16 ***
DESTIN_GRID1346      0.7197094  0.0168318    42.759  &lt; 2e-16 ***
DESTIN_GRID1347      1.8405569  0.0156969   117.256  &lt; 2e-16 ***
DESTIN_GRID1348      0.4596894  0.0166162    27.665  &lt; 2e-16 ***
DESTIN_GRID1349      1.2533861  0.0161405    77.655  &lt; 2e-16 ***
DESTIN_GRID1350     -0.0599248  0.0197183    -3.039 0.002373 ** 
DESTIN_GRID1353      0.7763834  0.0164475    47.204  &lt; 2e-16 ***
DESTIN_GRID1354     -0.4125147  0.0192557   -21.423  &lt; 2e-16 ***
DESTIN_GRID1355     -0.1608471  0.0187606    -8.574  &lt; 2e-16 ***
DESTIN_GRID1357     -0.6664133  0.0240466   -27.713  &lt; 2e-16 ***
DESTIN_GRID1358      1.9476498  0.0157327   123.796  &lt; 2e-16 ***
DESTIN_GRID1359      0.8264858  0.0166133    49.749  &lt; 2e-16 ***
DESTIN_GRID1360      0.6812764  0.0169296    40.242  &lt; 2e-16 ***
DESTIN_GRID1361      0.6887511  0.0175519    39.241  &lt; 2e-16 ***
DESTIN_GRID1362     -1.1403078  0.0327753   -34.792  &lt; 2e-16 ***
DESTIN_GRID1368     -0.0232924  0.0176576    -1.319 0.187131    
DESTIN_GRID1369     -0.1022846  0.0174959    -5.846 5.03e-09 ***
DESTIN_GRID1370      1.4671075  0.0157084    93.397  &lt; 2e-16 ***
DESTIN_GRID1371      0.4631126  0.0170528    27.158  &lt; 2e-16 ***
DESTIN_GRID1372      0.6780759  0.0167776    40.416  &lt; 2e-16 ***
DESTIN_GRID1373     -2.0895714  0.0358725   -58.250  &lt; 2e-16 ***
DESTIN_GRID1374     -0.9591100  0.0209152   -45.857  &lt; 2e-16 ***
DESTIN_GRID1375      1.0918241  0.0168775    64.691  &lt; 2e-16 ***
DESTIN_GRID1376     -0.3147252  0.0227217   -13.851  &lt; 2e-16 ***
DESTIN_GRID1379     -2.1371077  0.0649567   -32.901  &lt; 2e-16 ***
DESTIN_GRID1380      2.5641114  0.0155055   165.368  &lt; 2e-16 ***
DESTIN_GRID1381      2.9948101  0.0154565   193.758  &lt; 2e-16 ***
DESTIN_GRID1382      2.1768749  0.0158842   137.047  &lt; 2e-16 ***
DESTIN_GRID1383     -0.7581438  0.0246692   -30.732  &lt; 2e-16 ***
DESTIN_GRID1388      0.5867138  0.0165248    35.505  &lt; 2e-16 ***
DESTIN_GRID1389      0.2436894  0.0168704    14.445  &lt; 2e-16 ***
DESTIN_GRID1390      0.4554516  0.0167094    27.257  &lt; 2e-16 ***
DESTIN_GRID1391      1.2775106  0.0160356    79.667  &lt; 2e-16 ***
DESTIN_GRID1392      0.8263778  0.0196164    42.127  &lt; 2e-16 ***
DESTIN_GRID1393      0.0745337  0.0174808     4.264 2.01e-05 ***
DESTIN_GRID1394      0.4604816  0.0164448    28.002  &lt; 2e-16 ***
DESTIN_GRID1395      0.3174769  0.0167980    18.900  &lt; 2e-16 ***
DESTIN_GRID1396      1.1157774  0.0161345    69.155  &lt; 2e-16 ***
DESTIN_GRID1397      0.3092640  0.0170350    18.155  &lt; 2e-16 ***
DESTIN_GRID1398     -0.1942696  0.0206072    -9.427  &lt; 2e-16 ***
DESTIN_GRID1400      0.2267443  0.0188541    12.026  &lt; 2e-16 ***
DESTIN_GRID1401      1.9557748  0.0156317   125.116  &lt; 2e-16 ***
DESTIN_GRID1402      1.2750818  0.0161894    78.760  &lt; 2e-16 ***
DESTIN_GRID1404      0.3871043  0.0266104    14.547  &lt; 2e-16 ***
DESTIN_GRID1410      1.4812194  0.0157564    94.007  &lt; 2e-16 ***
DESTIN_GRID1411      0.5653750  0.0167245    33.805  &lt; 2e-16 ***
DESTIN_GRID1412      1.2536704  0.0158235    79.229  &lt; 2e-16 ***
DESTIN_GRID1413      0.9115262  0.0161933    56.290  &lt; 2e-16 ***
DESTIN_GRID1414      0.5965484  0.0163414    36.505  &lt; 2e-16 ***
DESTIN_GRID1415      0.9942714  0.0161867    61.425  &lt; 2e-16 ***
DESTIN_GRID1416      0.5599787  0.0166836    33.565  &lt; 2e-16 ***
DESTIN_GRID1417      0.8081309  0.0162834    49.629  &lt; 2e-16 ***
DESTIN_GRID1418      0.9505427  0.0162606    58.457  &lt; 2e-16 ***
DESTIN_GRID1419      0.3581626  0.0170976    20.948  &lt; 2e-16 ***
DESTIN_GRID1422      1.0347717  0.0164491    62.908  &lt; 2e-16 ***
DESTIN_GRID1423      1.6519911  0.0160956   102.636  &lt; 2e-16 ***
DESTIN_GRID1430      1.2221138  0.0160499    76.145  &lt; 2e-16 ***
DESTIN_GRID1431      1.6039829  0.0157038   102.140  &lt; 2e-16 ***
DESTIN_GRID1432      1.2003220  0.0158257    75.846  &lt; 2e-16 ***
DESTIN_GRID1433      0.6424036  0.0178087    36.073  &lt; 2e-16 ***
DESTIN_GRID1434      1.5384951  0.0158019    97.361  &lt; 2e-16 ***
DESTIN_GRID1435      1.1422798  0.0159748    71.505  &lt; 2e-16 ***
DESTIN_GRID1436     -0.2454224  0.0185482   -13.232  &lt; 2e-16 ***
DESTIN_GRID1437      0.6245838  0.0165173    37.814  &lt; 2e-16 ***
DESTIN_GRID1438      1.2055578  0.0158452    76.083  &lt; 2e-16 ***
DESTIN_GRID1439      1.8826454  0.0156599   120.220  &lt; 2e-16 ***
DESTIN_GRID1440      1.2567078  0.0164253    76.511  &lt; 2e-16 ***
DESTIN_GRID1442     -0.5610218  0.0224525   -24.987  &lt; 2e-16 ***
DESTIN_GRID1443      1.2878244  0.0163211    78.905  &lt; 2e-16 ***
DESTIN_GRID1444      2.2753895  0.0163346   139.299  &lt; 2e-16 ***
DESTIN_GRID1452      1.8644819  0.0156218   119.351  &lt; 2e-16 ***
DESTIN_GRID1453      1.0531114  0.0160634    65.560  &lt; 2e-16 ***
DESTIN_GRID1454     -0.0825690  0.0188821    -4.373 1.23e-05 ***
DESTIN_GRID1455      0.8207934  0.0167729    48.936  &lt; 2e-16 ***
DESTIN_GRID1456      0.9450275  0.0162923    58.005  &lt; 2e-16 ***
DESTIN_GRID1457      1.7586527  0.0158834   110.723  &lt; 2e-16 ***
DESTIN_GRID1458      2.4844700  0.0154860   160.433  &lt; 2e-16 ***
DESTIN_GRID1459      0.0957965  0.0172607     5.550 2.86e-08 ***
DESTIN_GRID1460      1.3216188  0.0158721    83.267  &lt; 2e-16 ***
DESTIN_GRID1461      1.0055735  0.0165874    60.623  &lt; 2e-16 ***
DESTIN_GRID1464      0.7997987  0.0167907    47.633  &lt; 2e-16 ***
DESTIN_GRID1465      0.6059659  0.0184718    32.805  &lt; 2e-16 ***
DESTIN_GRID1472      0.6867584  0.0168232    40.822  &lt; 2e-16 ***
DESTIN_GRID1473      1.7135201  0.0157136   109.047  &lt; 2e-16 ***
DESTIN_GRID1474      1.4965035  0.0156610    95.556  &lt; 2e-16 ***
DESTIN_GRID1475      1.3404175  0.0158220    84.719  &lt; 2e-16 ***
DESTIN_GRID1476      0.4878363  0.0168084    29.023  &lt; 2e-16 ***
DESTIN_GRID1477      2.3968468  0.0154651   154.984  &lt; 2e-16 ***
DESTIN_GRID1478      0.9625624  0.0160993    59.789  &lt; 2e-16 ***
DESTIN_GRID1479      0.1152810  0.0169602     6.797 1.07e-11 ***
DESTIN_GRID1480      2.4081852  0.0154822   155.546  &lt; 2e-16 ***
DESTIN_GRID1481      1.3050093  0.0163392    79.870  &lt; 2e-16 ***
DESTIN_GRID1482      1.8185665  0.0159950   113.696  &lt; 2e-16 ***
DESTIN_GRID1485     -0.0150183  0.0196524    -0.764 0.444749    
DESTIN_GRID1494      1.4475654  0.0158614    91.264  &lt; 2e-16 ***
DESTIN_GRID1495      0.4967405  0.0163633    30.357  &lt; 2e-16 ***
DESTIN_GRID1496      1.5452890  0.0156704    98.612  &lt; 2e-16 ***
DESTIN_GRID1497      0.3618022  0.0168761    21.439  &lt; 2e-16 ***
DESTIN_GRID1498      0.7238915  0.0164291    44.062  &lt; 2e-16 ***
DESTIN_GRID1499      1.1805014  0.0158812    74.333  &lt; 2e-16 ***
DESTIN_GRID150      -0.1937422  0.0293108    -6.610 3.85e-11 ***
DESTIN_GRID1500      0.6884793  0.0173873    39.597  &lt; 2e-16 ***
DESTIN_GRID1501      1.4920506  0.0157663    94.635  &lt; 2e-16 ***
DESTIN_GRID1502      1.5500482  0.0158572    97.750  &lt; 2e-16 ***
DESTIN_GRID1506     -2.4646241  0.0647137   -38.085  &lt; 2e-16 ***
DESTIN_GRID151      -0.3067861  0.0260832   -11.762  &lt; 2e-16 ***
DESTIN_GRID1515      0.2332969  0.0204977    11.382  &lt; 2e-16 ***
DESTIN_GRID1516      1.6613312  0.0156620   106.074  &lt; 2e-16 ***
DESTIN_GRID1517      0.8572995  0.0165443    51.819  &lt; 2e-16 ***
DESTIN_GRID1518      0.2160177  0.0171222    12.616  &lt; 2e-16 ***
DESTIN_GRID1519      1.0517405  0.0171411    61.358  &lt; 2e-16 ***
DESTIN_GRID152       1.0311723  0.0203033    50.788  &lt; 2e-16 ***
DESTIN_GRID1520      0.9106308  0.0161255    56.471  &lt; 2e-16 ***
DESTIN_GRID1521      0.3662690  0.0169508    21.608  &lt; 2e-16 ***
DESTIN_GRID1522      1.1926431  0.0159986    74.547  &lt; 2e-16 ***
DESTIN_GRID1523      2.5977350  0.0158572   163.820  &lt; 2e-16 ***
DESTIN_GRID1524      0.0680101  0.0190854     3.563 0.000366 ***
DESTIN_GRID1527     -1.2892587  0.0323368   -39.870  &lt; 2e-16 ***
DESTIN_GRID153       0.4147109  0.0197736    20.973  &lt; 2e-16 ***
DESTIN_GRID1535     -1.4403418  0.0526018   -27.382  &lt; 2e-16 ***
DESTIN_GRID1536     -0.9899491  0.0264572   -37.417  &lt; 2e-16 ***
DESTIN_GRID1537      0.9272607  0.0163326    56.774  &lt; 2e-16 ***
DESTIN_GRID1538      0.8709674  0.0160784    54.170  &lt; 2e-16 ***
DESTIN_GRID1539      1.0391055  0.0159122    65.303  &lt; 2e-16 ***
DESTIN_GRID154      -1.3154360  0.0306274   -42.950  &lt; 2e-16 ***
DESTIN_GRID1540      0.5514383  0.0164055    33.613  &lt; 2e-16 ***
DESTIN_GRID1541      1.9166168  0.0165469   115.829  &lt; 2e-16 ***
DESTIN_GRID1542      0.2836774  0.0179573    15.797  &lt; 2e-16 ***
DESTIN_GRID1543      0.0282867  0.0297219     0.952 0.341242    
DESTIN_GRID1544      0.5229462  0.0176548    29.621  &lt; 2e-16 ***
DESTIN_GRID1547     -0.1643651  0.0212094    -7.750 9.22e-15 ***
DESTIN_GRID155      -0.5768016  0.0229382   -25.146  &lt; 2e-16 ***
DESTIN_GRID1556     -2.1525268  0.0608895   -35.351  &lt; 2e-16 ***
DESTIN_GRID1557     -0.4144855  0.0218989   -18.927  &lt; 2e-16 ***
DESTIN_GRID1558      1.1319415  0.0195962    57.763  &lt; 2e-16 ***
DESTIN_GRID1559      1.4301416  0.0157423    90.847  &lt; 2e-16 ***
DESTIN_GRID156       0.0004862  0.0239402     0.020 0.983798    
DESTIN_GRID1560      1.5705732  0.0157174    99.926  &lt; 2e-16 ***
DESTIN_GRID1561      0.9896425  0.0165191    59.909  &lt; 2e-16 ***
DESTIN_GRID1562     -1.2851702  0.0225920   -56.886  &lt; 2e-16 ***
DESTIN_GRID1563     -0.1632155  0.0177361    -9.202  &lt; 2e-16 ***
DESTIN_GRID1564      0.2698150  0.0172679    15.625  &lt; 2e-16 ***
DESTIN_GRID1565      1.0990877  0.0164415    66.849  &lt; 2e-16 ***
DESTIN_GRID1566     -0.6312861  0.0222815   -28.332  &lt; 2e-16 ***
DESTIN_GRID1567     -0.4855000  0.0230259   -21.085  &lt; 2e-16 ***
DESTIN_GRID1568      0.1552451  0.0194066     8.000 1.25e-15 ***
DESTIN_GRID1578     -2.6660563  0.1001959   -26.608  &lt; 2e-16 ***
DESTIN_GRID1580     -1.3382013  0.0281331   -47.567  &lt; 2e-16 ***
DESTIN_GRID1581      1.2751419  0.0159494    79.949  &lt; 2e-16 ***
DESTIN_GRID1582      1.4145116  0.0157503    89.809  &lt; 2e-16 ***
DESTIN_GRID1583      0.1565323  0.0250401     6.251 4.07e-10 ***
DESTIN_GRID1584     -0.2391568  0.0193796   -12.341  &lt; 2e-16 ***
DESTIN_GRID1585      0.5963388  0.0169782    35.124  &lt; 2e-16 ***
DESTIN_GRID1586      1.2211691  0.0160731    75.976  &lt; 2e-16 ***
DESTIN_GRID1589     -0.2156554  0.0198846   -10.845  &lt; 2e-16 ***
DESTIN_GRID1590      0.3003779  0.0200692    14.967  &lt; 2e-16 ***
DESTIN_GRID1600      0.2027518  0.0207110     9.790  &lt; 2e-16 ***
DESTIN_GRID1601      0.1705282  0.0168071    10.146  &lt; 2e-16 ***
DESTIN_GRID1602      0.7652459  0.0165776    46.162  &lt; 2e-16 ***
DESTIN_GRID1603      1.8271857  0.0157496   116.014  &lt; 2e-16 ***
DESTIN_GRID1604     -0.3252816  0.0183390   -17.737  &lt; 2e-16 ***
DESTIN_GRID1605      0.7617288  0.0162632    46.838  &lt; 2e-16 ***
DESTIN_GRID1606      0.1622961  0.0201500     8.054 7.99e-16 ***
DESTIN_GRID1607      1.6415598  0.0158262   103.724  &lt; 2e-16 ***
DESTIN_GRID1608      0.8223370  0.0164369    50.030  &lt; 2e-16 ***
DESTIN_GRID1609      1.4454193  0.0160561    90.023  &lt; 2e-16 ***
DESTIN_GRID1610     -0.7087697  0.0297288   -23.841  &lt; 2e-16 ***
DESTIN_GRID1622      0.7098139  0.0186171    38.127  &lt; 2e-16 ***
DESTIN_GRID1623      1.2020577  0.0158322    75.925  &lt; 2e-16 ***
DESTIN_GRID1624      1.8567904  0.0157152   118.153  &lt; 2e-16 ***
DESTIN_GRID1625      1.0787950  0.0162289    66.474  &lt; 2e-16 ***
DESTIN_GRID1626      2.7420534  0.0154413   177.579  &lt; 2e-16 ***
DESTIN_GRID1627     -0.1350974  0.0175692    -7.689 1.48e-14 ***
DESTIN_GRID1628      1.9598854  0.0156503   125.230  &lt; 2e-16 ***
DESTIN_GRID1629     -0.6998469  0.0206705   -33.857  &lt; 2e-16 ***
DESTIN_GRID1630     -0.1452313  0.0189355    -7.670 1.72e-14 ***
DESTIN_GRID1631     -0.8991964  0.0241030   -37.306  &lt; 2e-16 ***
DESTIN_GRID1642     -1.6929071  0.0351611   -48.147  &lt; 2e-16 ***
DESTIN_GRID1643      0.7252959  0.0162983    44.501  &lt; 2e-16 ***
DESTIN_GRID1644      0.6823928  0.0171792    39.722  &lt; 2e-16 ***
DESTIN_GRID1645      0.6690665  0.0164528    40.666  &lt; 2e-16 ***
DESTIN_GRID1646      0.9421866  0.0170403    55.292  &lt; 2e-16 ***
DESTIN_GRID1647      0.6089873  0.0163828    37.172  &lt; 2e-16 ***
DESTIN_GRID1648      0.7157006  0.0162852    43.948  &lt; 2e-16 ***
DESTIN_GRID1649      1.4716426  0.0158060    93.106  &lt; 2e-16 ***
DESTIN_GRID1650      0.6725159  0.0168988    39.797  &lt; 2e-16 ***
DESTIN_GRID1664     -3.5769184  0.1172554   -30.505  &lt; 2e-16 ***
DESTIN_GRID1665      1.3656792  0.0157757    86.569  &lt; 2e-16 ***
DESTIN_GRID1666      1.4185998  0.0157740    89.933  &lt; 2e-16 ***
DESTIN_GRID1667      0.1768676  0.0218839     8.082 6.37e-16 ***
DESTIN_GRID1668      0.5361739  0.0166408    32.220  &lt; 2e-16 ***
DESTIN_GRID1670      1.2829670  0.0159044    80.667  &lt; 2e-16 ***
DESTIN_GRID1671      1.2051958  0.0184221    65.421  &lt; 2e-16 ***
DESTIN_GRID1672      0.2723606  0.0190970    14.262  &lt; 2e-16 ***
DESTIN_GRID1684      0.8730006  0.0178461    48.918  &lt; 2e-16 ***
DESTIN_GRID1685      0.0165064  0.0174996     0.943 0.345554    
DESTIN_GRID1686      0.7674124  0.0162672    47.176  &lt; 2e-16 ***
DESTIN_GRID1687      0.9386932  0.0166423    56.404  &lt; 2e-16 ***
DESTIN_GRID1688      0.4896171  0.0166296    29.443  &lt; 2e-16 ***
DESTIN_GRID1689      0.0161112  0.0180066     0.895 0.370929    
DESTIN_GRID1690     -0.3837272  0.0196998   -19.479  &lt; 2e-16 ***
DESTIN_GRID1691      1.5692305  0.0158666    98.902  &lt; 2e-16 ***
DESTIN_GRID1692     -0.3199893  0.0203211   -15.747  &lt; 2e-16 ***
DESTIN_GRID1706      0.5659943  0.0170087    33.277  &lt; 2e-16 ***
DESTIN_GRID1707     -0.0534329  0.0172104    -3.105 0.001905 ** 
DESTIN_GRID1708      0.5285972  0.0164391    32.155  &lt; 2e-16 ***
DESTIN_GRID1709      1.2495009  0.0159295    78.439  &lt; 2e-16 ***
DESTIN_GRID1710      1.2107202  0.0160565    75.404  &lt; 2e-16 ***
DESTIN_GRID1711      2.1581012  0.0156353   138.027  &lt; 2e-16 ***
DESTIN_GRID1712      1.3757547  0.0158396    86.856  &lt; 2e-16 ***
DESTIN_GRID1713     -0.7864920  0.0214491   -36.668  &lt; 2e-16 ***
DESTIN_GRID1714      0.6497301  0.0172261    37.718  &lt; 2e-16 ***
DESTIN_GRID172      -1.5568843  0.0468214   -33.252  &lt; 2e-16 ***
DESTIN_GRID1727      1.1293886  0.0161577    69.898  &lt; 2e-16 ***
DESTIN_GRID1728      1.2087499  0.0158907    76.067  &lt; 2e-16 ***
DESTIN_GRID1729      1.2799045  0.0158202    80.903  &lt; 2e-16 ***
DESTIN_GRID1730      0.3862439  0.0175055    22.064  &lt; 2e-16 ***
DESTIN_GRID1731      1.2425224  0.0160774    77.284  &lt; 2e-16 ***
DESTIN_GRID1732      1.1766235  0.0159174    73.921  &lt; 2e-16 ***
DESTIN_GRID1733      0.2113109  0.0171959    12.288  &lt; 2e-16 ***
DESTIN_GRID1734      1.4545199  0.0159638    91.114  &lt; 2e-16 ***
DESTIN_GRID1735      0.7775552  0.0205110    37.909  &lt; 2e-16 ***
DESTIN_GRID174       0.1845829  0.0209390     8.815  &lt; 2e-16 ***
DESTIN_GRID1748      0.2387531  0.0175484    13.605  &lt; 2e-16 ***
DESTIN_GRID1749      1.3856289  0.0157534    87.958  &lt; 2e-16 ***
DESTIN_GRID175       0.2221926  0.0184248    12.059  &lt; 2e-16 ***
DESTIN_GRID1750      1.3305032  0.0158260    84.071  &lt; 2e-16 ***
DESTIN_GRID1751      0.7533522  0.0164257    45.864  &lt; 2e-16 ***
DESTIN_GRID1753      1.3780120  0.0158849    86.750  &lt; 2e-16 ***
DESTIN_GRID1754      2.5550441  0.0154785   165.070  &lt; 2e-16 ***
DESTIN_GRID1755      1.9879338  0.0156424   127.086  &lt; 2e-16 ***
DESTIN_GRID1756      1.1677976  0.0161921    72.121  &lt; 2e-16 ***
DESTIN_GRID1757     -0.3706565  0.0265274   -13.973  &lt; 2e-16 ***
DESTIN_GRID176      -1.4203772  0.0308484   -46.044  &lt; 2e-16 ***
DESTIN_GRID1769      0.6641684  0.0165143    40.218  &lt; 2e-16 ***
DESTIN_GRID1770      0.4375352  0.0166417    26.291  &lt; 2e-16 ***
DESTIN_GRID1771      1.4381784  0.0160033    89.868  &lt; 2e-16 ***
DESTIN_GRID1772      1.7598619  0.0166751   105.538  &lt; 2e-16 ***
DESTIN_GRID1774      0.6641742  0.0167163    39.732  &lt; 2e-16 ***
DESTIN_GRID1775      0.3373948  0.0171446    19.679  &lt; 2e-16 ***
DESTIN_GRID1776      2.6229339  0.0154901   169.330  &lt; 2e-16 ***
DESTIN_GRID1777      0.8307521  0.0166871    49.784  &lt; 2e-16 ***
DESTIN_GRID1778     -0.0890480  0.0256787    -3.468 0.000525 ***
DESTIN_GRID1790      1.4102098  0.0160138    88.062  &lt; 2e-16 ***
DESTIN_GRID1791      0.9024772  0.0162906    55.399  &lt; 2e-16 ***
DESTIN_GRID1792      1.0461615  0.0167379    62.503  &lt; 2e-16 ***
DESTIN_GRID1793      0.9412379  0.0162432    57.946  &lt; 2e-16 ***
DESTIN_GRID1794      2.0801953  0.0168466   123.478  &lt; 2e-16 ***
DESTIN_GRID1795     -1.0163177  0.0262806   -38.672  &lt; 2e-16 ***
DESTIN_GRID1796      1.3017228  0.0161605    80.549  &lt; 2e-16 ***
DESTIN_GRID1797      1.0000164  0.0161780    61.813  &lt; 2e-16 ***
DESTIN_GRID1798      1.3884548  0.0160800    86.347  &lt; 2e-16 ***
DESTIN_GRID1799      0.3898741  0.0176749    22.058  &lt; 2e-16 ***
DESTIN_GRID1800     -1.2376681  0.0524201   -23.611  &lt; 2e-16 ***
DESTIN_GRID1811      0.4977813  0.0169467    29.373  &lt; 2e-16 ***
DESTIN_GRID1812      1.7967361  0.0156106   115.097  &lt; 2e-16 ***
DESTIN_GRID1813      1.9402182  0.0155942   124.419  &lt; 2e-16 ***
DESTIN_GRID1817     -0.1156777  0.0192518    -6.009 1.87e-09 ***
DESTIN_GRID1818      0.8948583  0.0163739    54.652  &lt; 2e-16 ***
DESTIN_GRID1819      2.6212253  0.0154982   169.131  &lt; 2e-16 ***
DESTIN_GRID1820     -2.0051590  0.0437721   -45.809  &lt; 2e-16 ***
DESTIN_GRID1832      1.7601412  0.0157937   111.446  &lt; 2e-16 ***
DESTIN_GRID1833      0.4470084  0.0167057    26.758  &lt; 2e-16 ***
DESTIN_GRID1834      0.4053256  0.0166345    24.367  &lt; 2e-16 ***
DESTIN_GRID1835      0.5319810  0.0169380    31.408  &lt; 2e-16 ***
DESTIN_GRID1837      0.6565414  0.0204848    32.050  &lt; 2e-16 ***
DESTIN_GRID1839     -0.0104287  0.0190447    -0.548 0.583973    
DESTIN_GRID1840      2.4711625  0.0155622   158.793  &lt; 2e-16 ***
DESTIN_GRID1841     -0.6755370  0.0269129   -25.101  &lt; 2e-16 ***
DESTIN_GRID1842      0.5520391  0.0209241    26.383  &lt; 2e-16 ***
DESTIN_GRID1853      0.7432434  0.0163035    45.588  &lt; 2e-16 ***
DESTIN_GRID1854      1.0631266  0.0160338    66.305  &lt; 2e-16 ***
DESTIN_GRID1855      1.5031021  0.0158951    94.564  &lt; 2e-16 ***
DESTIN_GRID1858      1.1310137  0.0174233    64.914  &lt; 2e-16 ***
DESTIN_GRID1860      0.7690202  0.0234599    32.780  &lt; 2e-16 ***
DESTIN_GRID1861      1.1446429  0.0164560    69.558  &lt; 2e-16 ***
DESTIN_GRID1874      0.4478343  0.0178206    25.130  &lt; 2e-16 ***
DESTIN_GRID1875     -1.0759027  0.0248507   -43.295  &lt; 2e-16 ***
DESTIN_GRID1876     -0.0530911  0.0264087    -2.010 0.044393 *  
DESTIN_GRID1877      1.2739997  0.0159978    79.636  &lt; 2e-16 ***
DESTIN_GRID1880      0.0873100  0.0206413     4.230 2.34e-05 ***
DESTIN_GRID1882      1.1592008  0.0164630    70.413  &lt; 2e-16 ***
DESTIN_GRID1883      0.1662298  0.0244038     6.812 9.65e-12 ***
DESTIN_GRID1895      0.9809778  0.0161873    60.602  &lt; 2e-16 ***
DESTIN_GRID1896      0.3254611  0.0170922    19.042  &lt; 2e-16 ***
DESTIN_GRID1897     -0.1019642  0.0191540    -5.323 1.02e-07 ***
DESTIN_GRID1898     -0.6969787  0.0282328   -24.687  &lt; 2e-16 ***
DESTIN_GRID1901      0.2356543  0.0258606     9.112  &lt; 2e-16 ***
DESTIN_GRID1903     -0.3013510  0.0227531   -13.244  &lt; 2e-16 ***
DESTIN_GRID1917      0.0965455  0.0175495     5.501 3.77e-08 ***
DESTIN_GRID1918      1.7367683  0.0164270   105.726  &lt; 2e-16 ***
DESTIN_GRID1919      1.6035095  0.0159070   100.805  &lt; 2e-16 ***
DESTIN_GRID1922      0.7279831  0.0183078    39.764  &lt; 2e-16 ***
DESTIN_GRID1924     -0.2738846  0.0240464   -11.390  &lt; 2e-16 ***
DESTIN_GRID1937      0.4994954  0.0170150    29.356  &lt; 2e-16 ***
DESTIN_GRID1938      1.5432483  0.0158703    97.241  &lt; 2e-16 ***
DESTIN_GRID1939      0.6662956  0.0172207    38.691  &lt; 2e-16 ***
DESTIN_GRID1942     -0.6314755  0.0250736   -25.185  &lt; 2e-16 ***
DESTIN_GRID195      -1.0436738  0.0334470   -31.204  &lt; 2e-16 ***
DESTIN_GRID1959      0.2589759  0.0177687    14.575  &lt; 2e-16 ***
DESTIN_GRID196       0.4545036  0.0182648    24.884  &lt; 2e-16 ***
DESTIN_GRID1960      2.6968182  0.0154482   174.572  &lt; 2e-16 ***
DESTIN_GRID1961      0.2299347  0.0182015    12.633  &lt; 2e-16 ***
DESTIN_GRID1962      1.0812298  0.0164237    65.833  &lt; 2e-16 ***
DESTIN_GRID1964      1.6464101  0.0188768    87.219  &lt; 2e-16 ***
DESTIN_GRID197      -2.4794742  0.0877381   -28.260  &lt; 2e-16 ***
DESTIN_GRID1979      0.4785538  0.0174172    27.476  &lt; 2e-16 ***
DESTIN_GRID1980      0.6798301  0.0166044    40.943  &lt; 2e-16 ***
DESTIN_GRID1981      0.7048286  0.0168612    41.802  &lt; 2e-16 ***
DESTIN_GRID1982      1.3076522  0.0167965    77.852  &lt; 2e-16 ***
DESTIN_GRID1983      1.0949779  0.0164191    66.689  &lt; 2e-16 ***
DESTIN_GRID1984      0.8909998  0.0164662    54.111  &lt; 2e-16 ***
DESTIN_GRID1985      1.3491690  0.0162521    83.015  &lt; 2e-16 ***
DESTIN_GRID2001      0.6504481  0.0165890    39.210  &lt; 2e-16 ***
DESTIN_GRID2002      1.0110332  0.0160235    63.097  &lt; 2e-16 ***
DESTIN_GRID2003      1.6558075  0.0158396   104.536  &lt; 2e-16 ***
DESTIN_GRID2004      1.9816243  0.0157961   125.450  &lt; 2e-16 ***
DESTIN_GRID2005      0.8011184  0.0164787    48.616  &lt; 2e-16 ***
DESTIN_GRID2006      1.8843660  0.0158898   118.590  &lt; 2e-16 ***
DESTIN_GRID2007     -1.2144200  0.0319025   -38.067  &lt; 2e-16 ***
DESTIN_GRID2022      1.3266468  0.0164933    80.436  &lt; 2e-16 ***
DESTIN_GRID2023      1.4044675  0.0159482    88.065  &lt; 2e-16 ***
DESTIN_GRID2024      1.7597479  0.0157333   111.849  &lt; 2e-16 ***
DESTIN_GRID2025      0.7262923  0.0165476    43.891  &lt; 2e-16 ***
DESTIN_GRID2026      0.0223252  0.0189208     1.180 0.238029    
DESTIN_GRID2027      1.6887288  0.0158590   106.484  &lt; 2e-16 ***
DESTIN_GRID2043     -0.1242027  0.0186785    -6.650 2.94e-11 ***
DESTIN_GRID2044      0.6771465  0.0164330    41.206  &lt; 2e-16 ***
DESTIN_GRID2045      0.3881917  0.0193496    20.062  &lt; 2e-16 ***
DESTIN_GRID2046      1.8418960  0.0156549   117.656  &lt; 2e-16 ***
DESTIN_GRID2047      0.1451720  0.0176866     8.208 2.25e-16 ***
DESTIN_GRID2048      0.2982636  0.0173386    17.202  &lt; 2e-16 ***
DESTIN_GRID2049     -1.4205476  0.0312065   -45.521  &lt; 2e-16 ***
DESTIN_GRID2064      0.5832779  0.0168535    34.609  &lt; 2e-16 ***
DESTIN_GRID2065      0.3629900  0.0170546    21.284  &lt; 2e-16 ***
DESTIN_GRID2066     -1.1225571  0.0347438   -32.310  &lt; 2e-16 ***
DESTIN_GRID2067      3.1021553  0.0154116   201.287  &lt; 2e-16 ***
DESTIN_GRID2068      0.3290658  0.0196564    16.741  &lt; 2e-16 ***
DESTIN_GRID2069      0.4944269  0.0172493    28.664  &lt; 2e-16 ***
DESTIN_GRID2085      0.5664190  0.0171180    33.089  &lt; 2e-16 ***
DESTIN_GRID2086      1.8848185  0.0156805   120.201  &lt; 2e-16 ***
DESTIN_GRID2087      1.7091526  0.0157525   108.500  &lt; 2e-16 ***
DESTIN_GRID2088      0.8784823  0.0162517    54.055  &lt; 2e-16 ***
DESTIN_GRID2089      0.5503918  0.0176848    31.122  &lt; 2e-16 ***
DESTIN_GRID2090      2.7515006  0.0154650   177.918  &lt; 2e-16 ***
DESTIN_GRID2091     -1.7215737  0.0635420   -27.093  &lt; 2e-16 ***
DESTIN_GRID2105     -0.1295795  0.0769235    -1.685 0.092081 .  
DESTIN_GRID2106     -0.8128532  0.0214538   -37.888  &lt; 2e-16 ***
DESTIN_GRID2107      1.8099125  0.0156930   115.332  &lt; 2e-16 ***
DESTIN_GRID2108      1.6214363  0.0159141   101.886  &lt; 2e-16 ***
DESTIN_GRID2109      0.6820160  0.0165256    41.270  &lt; 2e-16 ***
DESTIN_GRID2110      0.0338241  0.0192791     1.754 0.079355 .  
DESTIN_GRID2111     -0.9262772  0.0361860   -25.598  &lt; 2e-16 ***
DESTIN_GRID2128      0.6267236  0.0177578    35.293  &lt; 2e-16 ***
DESTIN_GRID2129      0.1920265  0.0181057    10.606  &lt; 2e-16 ***
DESTIN_GRID2130      0.9275101  0.0161543    57.416  &lt; 2e-16 ***
DESTIN_GRID2131      0.9288310  0.0168562    55.103  &lt; 2e-16 ***
DESTIN_GRID2132      0.6645542  0.0168869    39.353  &lt; 2e-16 ***
DESTIN_GRID2148     -0.0086502  0.0207493    -0.417 0.676756    
DESTIN_GRID2149     -0.0043938  0.0186361    -0.236 0.813610    
DESTIN_GRID215      -0.0192104  0.0314105    -0.612 0.540807    
DESTIN_GRID2150      0.4068446  0.0171555    23.715  &lt; 2e-16 ***
DESTIN_GRID2151      2.1865318  0.0155530   140.585  &lt; 2e-16 ***
DESTIN_GRID2152      1.3219380  0.0160815    82.202  &lt; 2e-16 ***
DESTIN_GRID2153      0.0478911  0.0188671     2.538 0.011138 *  
DESTIN_GRID216      -0.5912396  0.0219317   -26.958  &lt; 2e-16 ***
DESTIN_GRID217       0.9125491  0.0176626    51.666  &lt; 2e-16 ***
DESTIN_GRID2171      1.1349518  0.0161519    70.267  &lt; 2e-16 ***
DESTIN_GRID2172     -0.1284615  0.0189275    -6.787 1.14e-11 ***
DESTIN_GRID2173      0.3861041  0.0169181    22.822  &lt; 2e-16 ***
DESTIN_GRID2174      0.8358931  0.0166892    50.086  &lt; 2e-16 ***
DESTIN_GRID2191      1.1660227  0.0169072    68.966  &lt; 2e-16 ***
DESTIN_GRID2192      0.0262559  0.0185624     1.414 0.157225    
DESTIN_GRID2193      0.9281941  0.0164043    56.582  &lt; 2e-16 ***
DESTIN_GRID2194      0.9012748  0.0163097    55.260  &lt; 2e-16 ***
DESTIN_GRID2195     -0.4498962  0.0371236   -12.119  &lt; 2e-16 ***
DESTIN_GRID2212      1.1448635  0.0201925    56.697  &lt; 2e-16 ***
DESTIN_GRID2213      0.9633395  0.0172465    55.857  &lt; 2e-16 ***
DESTIN_GRID2214      1.6704069  0.0167071    99.982  &lt; 2e-16 ***
DESTIN_GRID2215      0.1671811  0.0178139     9.385  &lt; 2e-16 ***
DESTIN_GRID2216      1.1650889  0.0163465    71.275  &lt; 2e-16 ***
DESTIN_GRID2233      1.7783482  0.0180441    98.556  &lt; 2e-16 ***
DESTIN_GRID2234      1.9295429  0.0172425   111.906  &lt; 2e-16 ***
DESTIN_GRID2235      0.8237739  0.0176957    46.552  &lt; 2e-16 ***
DESTIN_GRID2236     -0.3358764  0.0203367   -16.516  &lt; 2e-16 ***
DESTIN_GRID2237      0.4685123  0.0190635    24.576  &lt; 2e-16 ***
DESTIN_GRID2256      0.6226747  0.0197091    31.593  &lt; 2e-16 ***
DESTIN_GRID2257     -1.5539932  0.0300253   -51.756  &lt; 2e-16 ***
DESTIN_GRID2258      0.5468213  0.0169354    32.289  &lt; 2e-16 ***
DESTIN_GRID2259      1.4240324  0.0182603    77.985  &lt; 2e-16 ***
DESTIN_GRID2277     -0.1246099  0.0288932    -4.313 1.61e-05 ***
DESTIN_GRID2278     -0.2352550  0.0218193   -10.782  &lt; 2e-16 ***
DESTIN_GRID2279      0.6323373  0.0169138    37.386  &lt; 2e-16 ***
DESTIN_GRID2280     -1.0336309  0.0351753   -29.385  &lt; 2e-16 ***
DESTIN_GRID2297      0.1395510  0.0221046     6.313 2.73e-10 ***
DESTIN_GRID23       -0.8830670  0.0484252   -18.236  &lt; 2e-16 ***
DESTIN_GRID2300     -0.5078944  0.0249458   -20.360  &lt; 2e-16 ***
DESTIN_GRID2301      0.2231864  0.0181208    12.317  &lt; 2e-16 ***
DESTIN_GRID2318      2.3045407  0.0162284   142.007  &lt; 2e-16 ***
DESTIN_GRID2319      2.1994103  0.0160656   136.902  &lt; 2e-16 ***
DESTIN_GRID2322      0.6809559  0.0178879    38.068  &lt; 2e-16 ***
DESTIN_GRID2337      1.0549878  0.0217810    48.436  &lt; 2e-16 ***
DESTIN_GRID2341      2.4018752  0.0160161   149.966  &lt; 2e-16 ***
DESTIN_GRID2343     -0.1997124  0.0198162   -10.078  &lt; 2e-16 ***
DESTIN_GRID2361      1.2039789  0.0175512    68.598  &lt; 2e-16 ***
DESTIN_GRID2364     -1.4698131  0.0332736   -44.174  &lt; 2e-16 ***
DESTIN_GRID237      -0.5791796  0.0322965   -17.933  &lt; 2e-16 ***
DESTIN_GRID2379      0.1283626  0.0293042     4.380 1.18e-05 ***
DESTIN_GRID238      -0.1166592  0.0211685    -5.511 3.57e-08 ***
DESTIN_GRID2384      1.7873375  0.0166133   107.585  &lt; 2e-16 ***
DESTIN_GRID239      -0.4109406  0.0332851   -12.346  &lt; 2e-16 ***
DESTIN_GRID2405      2.1746019  0.0159742   136.132  &lt; 2e-16 ***
DESTIN_GRID2406     -0.8859277  0.0283742   -31.223  &lt; 2e-16 ***
DESTIN_GRID2426      1.5109968  0.0188084    80.336  &lt; 2e-16 ***
DESTIN_GRID2427      1.7550811  0.0166389   105.480  &lt; 2e-16 ***
DESTIN_GRID2505      1.7231447  0.0237122    72.669  &lt; 2e-16 ***
DESTIN_GRID257       0.2675292  0.0212359    12.598  &lt; 2e-16 ***
DESTIN_GRID258      -0.6985376  0.0246019   -28.394  &lt; 2e-16 ***
DESTIN_GRID259       0.8217388  0.0193985    42.361  &lt; 2e-16 ***
DESTIN_GRID278       0.1665873  0.0215793     7.720 1.17e-14 ***
DESTIN_GRID279       0.0249435  0.0197594     1.262 0.206818    
DESTIN_GRID280       0.7427664  0.0194170    38.253  &lt; 2e-16 ***
DESTIN_GRID298      -2.8416663  0.1333385   -21.312  &lt; 2e-16 ***
DESTIN_GRID299       0.1860840  0.0222103     8.378  &lt; 2e-16 ***
DESTIN_GRID300      -0.3825338  0.0226579   -16.883  &lt; 2e-16 ***
DESTIN_GRID320       0.2931045  0.0201183    14.569  &lt; 2e-16 ***
DESTIN_GRID321      -0.4365130  0.0274247   -15.917  &lt; 2e-16 ***
DESTIN_GRID322       1.4672164  0.0191005    76.816  &lt; 2e-16 ***
DESTIN_GRID340       1.5613160  0.0187059    83.466  &lt; 2e-16 ***
DESTIN_GRID341       0.3131274  0.0192448    16.271  &lt; 2e-16 ***
DESTIN_GRID342       1.5020999  0.0182553    82.283  &lt; 2e-16 ***
DESTIN_GRID363       0.2332615  0.0202196    11.536  &lt; 2e-16 ***
DESTIN_GRID364       2.0971448  0.0169857   123.465  &lt; 2e-16 ***
DESTIN_GRID383       0.5601122  0.0175714    31.876  &lt; 2e-16 ***
DESTIN_GRID384       1.6350718  0.0172710    94.671  &lt; 2e-16 ***
DESTIN_GRID385       0.7418269  0.0212745    34.869  &lt; 2e-16 ***
DESTIN_GRID404       1.0656080  0.0212280    50.198  &lt; 2e-16 ***
DESTIN_GRID405       0.8904431  0.0183064    48.641  &lt; 2e-16 ***
DESTIN_GRID406       1.1457881  0.0160641    71.326  &lt; 2e-16 ***
DESTIN_GRID407       2.2903523  0.0174099   131.555  &lt; 2e-16 ***
DESTIN_GRID408       2.8390490  0.0159077   178.471  &lt; 2e-16 ***
DESTIN_GRID425      -0.3603254  0.0281497   -12.800  &lt; 2e-16 ***
DESTIN_GRID426       0.8280525  0.0183639    45.091  &lt; 2e-16 ***
DESTIN_GRID427      -1.2440036  0.0276986   -44.912  &lt; 2e-16 ***
DESTIN_GRID428       0.9080067  0.0184327    49.261  &lt; 2e-16 ***
DESTIN_GRID429       0.2087274  0.0273325     7.637 2.23e-14 ***
DESTIN_GRID44        1.5917420  0.0260346    61.139  &lt; 2e-16 ***
DESTIN_GRID446       0.6099555  0.0267985    22.761  &lt; 2e-16 ***
DESTIN_GRID447      -0.3223832  0.0229587   -14.042  &lt; 2e-16 ***
DESTIN_GRID448       0.6859782  0.0190882    35.937  &lt; 2e-16 ***
DESTIN_GRID449       1.2016295  0.0170478    70.486  &lt; 2e-16 ***
DESTIN_GRID450       0.4163667  0.0193140    21.558  &lt; 2e-16 ***
DESTIN_GRID46        0.4831832  0.0250245    19.308  &lt; 2e-16 ***
DESTIN_GRID468       0.8694922  0.0182836    47.556  &lt; 2e-16 ***
DESTIN_GRID469       0.7453686  0.0174627    42.683  &lt; 2e-16 ***
DESTIN_GRID470       1.1063369  0.0166905    66.285  &lt; 2e-16 ***
DESTIN_GRID471       0.1845691  0.0216717     8.517  &lt; 2e-16 ***
DESTIN_GRID488       0.0368115  0.0269752     1.365 0.172366    
DESTIN_GRID489      -1.3314680  0.0496233   -26.832  &lt; 2e-16 ***
DESTIN_GRID490       0.8976721  0.0174112    51.557  &lt; 2e-16 ***
DESTIN_GRID491      -0.4001872  0.0212621   -18.822  &lt; 2e-16 ***
DESTIN_GRID493      -1.7153557  0.0516564   -33.207  &lt; 2e-16 ***
DESTIN_GRID494      -0.4076747  0.0265977   -15.327  &lt; 2e-16 ***
DESTIN_GRID509      -0.2521953  0.0210895   -11.958  &lt; 2e-16 ***
DESTIN_GRID510       1.0161315  0.0181000    56.140  &lt; 2e-16 ***
DESTIN_GRID511       0.8961868  0.0165957    54.001  &lt; 2e-16 ***
DESTIN_GRID512       1.0247047  0.0164297    62.369  &lt; 2e-16 ***
DESTIN_GRID513       1.5140548  0.0168860    89.663  &lt; 2e-16 ***
DESTIN_GRID514       0.5937501  0.0192226    30.888  &lt; 2e-16 ***
DESTIN_GRID515      -0.3413389  0.0327860   -10.411  &lt; 2e-16 ***
DESTIN_GRID530      -1.0554373  0.0332738   -31.720  &lt; 2e-16 ***
DESTIN_GRID531       1.5825587  0.0163313    96.903  &lt; 2e-16 ***
DESTIN_GRID532       0.5501329  0.0175981    31.261  &lt; 2e-16 ***
DESTIN_GRID533       2.4978388  0.0155672   160.455  &lt; 2e-16 ***
DESTIN_GRID534       1.3144272  0.0165074    79.626  &lt; 2e-16 ***
DESTIN_GRID536      -0.4359825  0.0232798   -18.728  &lt; 2e-16 ***
DESTIN_GRID537      -0.6587405  0.0368120   -17.895  &lt; 2e-16 ***
DESTIN_GRID538      -1.5081526  0.0450625   -33.468  &lt; 2e-16 ***
DESTIN_GRID539      -3.7306306  0.5775541    -6.459 1.05e-10 ***
DESTIN_GRID551      -0.3062577  0.0233597   -13.111  &lt; 2e-16 ***
DESTIN_GRID552       2.2402965  0.0184643   121.331  &lt; 2e-16 ***
DESTIN_GRID553       0.6573826  0.0174492    37.674  &lt; 2e-16 ***
DESTIN_GRID554       0.9235477  0.0167041    55.289  &lt; 2e-16 ***
DESTIN_GRID555       1.2743525  0.0169776    75.061  &lt; 2e-16 ***
DESTIN_GRID559      -1.7155144  0.0564371   -30.397  &lt; 2e-16 ***
DESTIN_GRID560       0.4578555  0.0222117    20.613  &lt; 2e-16 ***
DESTIN_GRID561      -0.6994980  0.0689947   -10.138  &lt; 2e-16 ***
DESTIN_GRID572      -0.2240857  0.0357955    -6.260 3.85e-10 ***
DESTIN_GRID573       0.7923842  0.0182369    43.449  &lt; 2e-16 ***
DESTIN_GRID574       0.6594190  0.0222636    29.619  &lt; 2e-16 ***
DESTIN_GRID575       2.9911304  0.0154239   193.928  &lt; 2e-16 ***
DESTIN_GRID576       1.0236093  0.0165149    61.981  &lt; 2e-16 ***
DESTIN_GRID578      -2.5439715  0.1076984   -23.621  &lt; 2e-16 ***
DESTIN_GRID582      -2.0056194  0.0675596   -29.687  &lt; 2e-16 ***
DESTIN_GRID583      -3.2141472  0.2187564   -14.693  &lt; 2e-16 ***
DESTIN_GRID584      -0.4411998  0.0380256   -11.603  &lt; 2e-16 ***
DESTIN_GRID593      -0.4593369  0.0281772   -16.302  &lt; 2e-16 ***
DESTIN_GRID594       0.1435275  0.0201907     7.109 1.17e-12 ***
DESTIN_GRID595       1.2986753  0.0163192    79.579  &lt; 2e-16 ***
DESTIN_GRID596       1.2445394  0.0161074    77.265  &lt; 2e-16 ***
DESTIN_GRID597       0.8862440  0.0216399    40.954  &lt; 2e-16 ***
DESTIN_GRID603      -1.8929211  0.0532866   -35.523  &lt; 2e-16 ***
DESTIN_GRID604       0.6976558  0.0469878    14.848  &lt; 2e-16 ***
DESTIN_GRID615      -0.4281831  0.0210625   -20.329  &lt; 2e-16 ***
DESTIN_GRID616       1.1165663  0.0174014    64.165  &lt; 2e-16 ***
DESTIN_GRID617       0.1784481  0.0177728    10.040  &lt; 2e-16 ***
DESTIN_GRID618       1.0243992  0.0164582    62.242  &lt; 2e-16 ***
DESTIN_GRID620       0.6171435  0.0187442    32.925  &lt; 2e-16 ***
DESTIN_GRID637       0.5960105  0.0186242    32.002  &lt; 2e-16 ***
DESTIN_GRID638       1.0473424  0.0162849    64.314  &lt; 2e-16 ***
DESTIN_GRID657       1.2137015  0.0167212    72.585  &lt; 2e-16 ***
DESTIN_GRID658       0.9853285  0.0163614    60.223  &lt; 2e-16 ***
DESTIN_GRID659       1.2614599  0.0162696    77.535  &lt; 2e-16 ***
DESTIN_GRID66       -0.1821550  0.0460660    -3.954 7.68e-05 ***
DESTIN_GRID660       1.8186298  0.0157774   115.268  &lt; 2e-16 ***
DESTIN_GRID662       0.6309666  0.0188410    33.489  &lt; 2e-16 ***
DESTIN_GRID67        0.3626945  0.0200497    18.090  &lt; 2e-16 ***
DESTIN_GRID677       1.4699871  0.0177842    82.657  &lt; 2e-16 ***
DESTIN_GRID678      -0.2742363  0.0205351   -13.355  &lt; 2e-16 ***
DESTIN_GRID679       1.2903328  0.0160354    80.468  &lt; 2e-16 ***
DESTIN_GRID68        0.5175164  0.0244007    21.209  &lt; 2e-16 ***
DESTIN_GRID680       3.1023877  0.0154618   200.649  &lt; 2e-16 ***
DESTIN_GRID681      -0.1143251  0.0234766    -4.870 1.12e-06 ***
DESTIN_GRID699       0.7308496  0.0175509    41.642  &lt; 2e-16 ***
DESTIN_GRID700       1.0003462  0.0166537    60.067  &lt; 2e-16 ***
DESTIN_GRID701      -0.9549523  0.0243981   -39.141  &lt; 2e-16 ***
DESTIN_GRID702       1.4063719  0.0159774    88.023  &lt; 2e-16 ***
DESTIN_GRID704       1.0566373  0.0182926    57.763  &lt; 2e-16 ***
DESTIN_GRID722       0.6085683  0.0180258    33.761  &lt; 2e-16 ***
DESTIN_GRID725      -0.9378219  0.0308153   -30.434  &lt; 2e-16 ***
DESTIN_GRID741       1.2907399  0.0167540    77.041  &lt; 2e-16 ***
DESTIN_GRID743      -1.3601507  0.0258640   -52.589  &lt; 2e-16 ***
DESTIN_GRID744       1.4933916  0.0160140    93.256  &lt; 2e-16 ***
DESTIN_GRID761       1.3732313  0.0172540    79.589  &lt; 2e-16 ***
DESTIN_GRID762      -0.1926710  0.0197605    -9.750  &lt; 2e-16 ***
DESTIN_GRID763      -1.2876056  0.0254226   -50.648  &lt; 2e-16 ***
DESTIN_GRID764       1.8662876  0.0156603   119.173  &lt; 2e-16 ***
DESTIN_GRID765       0.8048223  0.0177830    45.258  &lt; 2e-16 ***
DESTIN_GRID767       1.2063501  0.0166675    72.378  &lt; 2e-16 ***
DESTIN_GRID772      -1.0213666  0.0377406   -27.063  &lt; 2e-16 ***
DESTIN_GRID784      -0.9600992  0.0249971   -38.408  &lt; 2e-16 ***
DESTIN_GRID785       0.7509750  0.0162232    46.290  &lt; 2e-16 ***
DESTIN_GRID786       1.2372185  0.0160402    77.133  &lt; 2e-16 ***
DESTIN_GRID787       0.7656921  0.0179313    42.701  &lt; 2e-16 ***
DESTIN_GRID788      -0.0195350  0.0206264    -0.947 0.343594    
DESTIN_GRID789       0.0011932  0.0226242     0.053 0.957938    
DESTIN_GRID803       0.1441244  0.0204634     7.043 1.88e-12 ***
DESTIN_GRID804       0.8748707  0.0166223    52.632  &lt; 2e-16 ***
DESTIN_GRID805       2.1864677  0.0155354   140.741  &lt; 2e-16 ***
DESTIN_GRID806       0.8750883  0.0163246    53.606  &lt; 2e-16 ***
DESTIN_GRID807       1.1265508  0.0167360    67.313  &lt; 2e-16 ***
DESTIN_GRID808      -0.6867893  0.0248772   -27.607  &lt; 2e-16 ***
DESTIN_GRID809       1.1860877  0.0161553    73.418  &lt; 2e-16 ***
DESTIN_GRID810       1.0682473  0.0174605    61.181  &lt; 2e-16 ***
DESTIN_GRID814      -0.3035324  0.0245604   -12.359  &lt; 2e-16 ***
DESTIN_GRID824       0.2074571  0.0202312    10.254  &lt; 2e-16 ***
DESTIN_GRID826       0.7092488  0.0164025    43.240  &lt; 2e-16 ***
DESTIN_GRID827       0.7650898  0.0164646    46.469  &lt; 2e-16 ***
DESTIN_GRID828       1.1724632  0.0159981    73.288  &lt; 2e-16 ***
DESTIN_GRID829       0.6316573  0.0172896    36.534  &lt; 2e-16 ***
DESTIN_GRID830      -0.0551291  0.0198169    -2.782 0.005404 ** 
DESTIN_GRID831       2.8127690  0.0154739   181.775  &lt; 2e-16 ***
DESTIN_GRID832       3.0983979  0.0156228   198.326  &lt; 2e-16 ***
DESTIN_GRID835      -0.7385822  0.0245495   -30.085  &lt; 2e-16 ***
DESTIN_GRID844      -0.0588989  0.0234280    -2.514 0.011936 *  
DESTIN_GRID846       0.6016906  0.0167335    35.957  &lt; 2e-16 ***
DESTIN_GRID847       1.6960830  0.0158887   106.748  &lt; 2e-16 ***
DESTIN_GRID848       0.7640640  0.0164801    46.363  &lt; 2e-16 ***
DESTIN_GRID849       0.3892298  0.0173006    22.498  &lt; 2e-16 ***
DESTIN_GRID850       1.0644105  0.0162802    65.381  &lt; 2e-16 ***
DESTIN_GRID851       0.7994043  0.0164309    48.652  &lt; 2e-16 ***
DESTIN_GRID852       0.8085624  0.0173592    46.578  &lt; 2e-16 ***
DESTIN_GRID853       1.7023959  0.0171795    99.095  &lt; 2e-16 ***
DESTIN_GRID854       0.1701846  0.0207309     8.209 2.23e-16 ***
DESTIN_GRID855      -0.7694658  0.0247318   -31.112  &lt; 2e-16 ***
DESTIN_GRID856      -1.6629102  0.0347708   -47.825  &lt; 2e-16 ***
DESTIN_GRID86       -0.9114015  0.0376846   -24.185  &lt; 2e-16 ***
DESTIN_GRID866       0.7499130  0.0181879    41.231  &lt; 2e-16 ***
DESTIN_GRID867       2.0651946  0.0159045   129.849  &lt; 2e-16 ***
DESTIN_GRID868       1.6931844  0.0161310   104.964  &lt; 2e-16 ***
DESTIN_GRID869       2.2134191  0.0160316   138.066  &lt; 2e-16 ***
DESTIN_GRID87       -2.2705818  0.0883796   -25.691  &lt; 2e-16 ***
DESTIN_GRID870       2.2578608  0.0155294   145.393  &lt; 2e-16 ***
DESTIN_GRID871       2.7333490  0.0157155   173.927  &lt; 2e-16 ***
DESTIN_GRID872       1.2989634  0.0162213    80.078  &lt; 2e-16 ***
DESTIN_GRID873       1.0813099  0.0171495    63.052  &lt; 2e-16 ***
DESTIN_GRID874      -0.5289567  0.0201444   -26.258  &lt; 2e-16 ***
DESTIN_GRID875      -1.0794037  0.0320282   -33.702  &lt; 2e-16 ***
DESTIN_GRID876      -0.5137287  0.0244007   -21.054  &lt; 2e-16 ***
DESTIN_GRID877       0.0973412  0.0207285     4.696 2.65e-06 ***
DESTIN_GRID88       -0.4369507  0.0226156   -19.321  &lt; 2e-16 ***
DESTIN_GRID887       0.7784196  0.0173137    44.960  &lt; 2e-16 ***
DESTIN_GRID888      -0.4329295  0.0203666   -21.257  &lt; 2e-16 ***
DESTIN_GRID889      -0.0746069  0.0198571    -3.757 0.000172 ***
DESTIN_GRID89        0.1755986  0.0262412     6.692 2.21e-11 ***
DESTIN_GRID890       1.2649777  0.0159928    79.097  &lt; 2e-16 ***
DESTIN_GRID891       0.4874889  0.0208300    23.403  &lt; 2e-16 ***
DESTIN_GRID893       1.4838053  0.0158830    93.421  &lt; 2e-16 ***
DESTIN_GRID894      -0.1993596  0.0191685   -10.400  &lt; 2e-16 ***
DESTIN_GRID895       0.4084090  0.0178661    22.859  &lt; 2e-16 ***
DESTIN_GRID896      -1.2912624  0.0336236   -38.403  &lt; 2e-16 ***
DESTIN_GRID897      -1.8802507  0.0311456   -60.370  &lt; 2e-16 ***
DESTIN_GRID898      -0.0478171  0.0207530    -2.304 0.021217 *  
DESTIN_GRID90       -3.5030272  0.5002349    -7.003 2.51e-12 ***
DESTIN_GRID908       0.8723043  0.0184295    47.332  &lt; 2e-16 ***
DESTIN_GRID909       0.5440998  0.0165354    32.905  &lt; 2e-16 ***
DESTIN_GRID910      -0.3525929  0.0192810   -18.287  &lt; 2e-16 ***
DESTIN_GRID911       1.9491279  0.0157459   123.786  &lt; 2e-16 ***
DESTIN_GRID912       0.3893230  0.0168213    23.145  &lt; 2e-16 ***
DESTIN_GRID915       1.0455261  0.0163613    63.903  &lt; 2e-16 ***
DESTIN_GRID917       1.5012334  0.0162367    92.459  &lt; 2e-16 ***
DESTIN_GRID918      -1.8401362  0.0426919   -43.103  &lt; 2e-16 ***
DESTIN_GRID919      -0.4331477  0.0210543   -20.573  &lt; 2e-16 ***
DESTIN_GRID928      -0.4838643  0.0228185   -21.205  &lt; 2e-16 ***
DESTIN_GRID929       0.5075198  0.0167229    30.349  &lt; 2e-16 ***
DESTIN_GRID930       1.5712282  0.0157014   100.069  &lt; 2e-16 ***
DESTIN_GRID931       0.1577410  0.0183160     8.612  &lt; 2e-16 ***
DESTIN_GRID932      -0.8146507  0.0286972   -28.388  &lt; 2e-16 ***
DESTIN_GRID933       0.6971059  0.0169777    41.060  &lt; 2e-16 ***
DESTIN_GRID934       0.5869395  0.0172669    33.992  &lt; 2e-16 ***
DESTIN_GRID935       2.7787154  0.0154621   179.711  &lt; 2e-16 ***
DESTIN_GRID938      -3.7828112  0.1747521   -21.647  &lt; 2e-16 ***
DESTIN_GRID939       2.4184203  0.0156423   154.607  &lt; 2e-16 ***
DESTIN_GRID940      -0.2909607  0.0240538   -12.096  &lt; 2e-16 ***
DESTIN_GRID949      -0.4825890  0.0209724   -23.011  &lt; 2e-16 ***
DESTIN_GRID950       1.6677066  0.0160202   104.100  &lt; 2e-16 ***
DESTIN_GRID951       2.3642300  0.0154934   152.596  &lt; 2e-16 ***
DESTIN_GRID952       1.8116408  0.0170657   106.157  &lt; 2e-16 ***
DESTIN_GRID953       0.5495382  0.0174706    31.455  &lt; 2e-16 ***
DESTIN_GRID954      -1.1302107  0.0228833   -49.390  &lt; 2e-16 ***
DESTIN_GRID955       1.5830656  0.0158573    99.832  &lt; 2e-16 ***
DESTIN_GRID956       0.2388909  0.0177633    13.449  &lt; 2e-16 ***
DESTIN_GRID957       1.0635006  0.0174257    61.031  &lt; 2e-16 ***
DESTIN_GRID959      -0.4305350  0.0266994   -16.125  &lt; 2e-16 ***
DESTIN_GRID961       0.6631480  0.0193403    34.288  &lt; 2e-16 ***
DESTIN_GRID962       2.3004124  0.0159711   144.036  &lt; 2e-16 ***
DESTIN_GRID970       0.8330317  0.0164326    50.694  &lt; 2e-16 ***
DESTIN_GRID971       1.0851625  0.0159079    68.215  &lt; 2e-16 ***
DESTIN_GRID972       0.4790614  0.0167523    28.597  &lt; 2e-16 ***
DESTIN_GRID974       0.1019255  0.0184509     5.524 3.31e-08 ***
DESTIN_GRID975      -1.0188752  0.0221113   -46.079  &lt; 2e-16 ***
DESTIN_GRID976      -0.0846275  0.0188721    -4.484 7.32e-06 ***
DESTIN_GRID977       0.7670811  0.0165258    46.417  &lt; 2e-16 ***
DESTIN_GRID978       0.8021520  0.0186482    43.015  &lt; 2e-16 ***
DESTIN_GRID982       0.1213611  0.0186428     6.510 7.52e-11 ***
DESTIN_GRID991       0.7733442  0.0166622    46.413  &lt; 2e-16 ***
DESTIN_GRID992       1.0721434  0.0161635    66.331  &lt; 2e-16 ***
DESTIN_GRID993      -0.2686992  0.0179638   -14.958  &lt; 2e-16 ***
DESTIN_GRID994      -0.4444034  0.0188940   -23.521  &lt; 2e-16 ***
DESTIN_GRID995       0.2332744  0.0171537    13.599  &lt; 2e-16 ***
DESTIN_GRID996      -0.0456008  0.0186483    -2.445 0.014473 *  
DESTIN_GRID997       0.4136303  0.0200481    20.632  &lt; 2e-16 ***
DESTIN_GRID998       1.1879490  0.0163109    72.832  &lt; 2e-16 ***
DESTIN_GRID999       0.7566136  0.0180680    41.876  &lt; 2e-16 ***
log(SCHOOL_COUNT)           NA         NA        NA       NA    
log(FIN_COUNT)              NA         NA        NA       NA    
log(FNB_COUNT)              NA         NA        NA       NA    
log(ent_COUNT)              NA         NA        NA       NA    
log(stn_exit_COUNT)         NA         NA        NA       NA    
log(HDB_COUNT)              NA         NA        NA       NA    
log(lnr_COUNT)              NA         NA        NA       NA    
log(DIST)           -1.4558973  0.0002586 -5628.893  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 97210253  on 65110  degrees of freedom
Residual deviance: 44339173  on 64295  degrees of freedom
AIC: 44698881

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3135085</code></pre>
</div>
</div>
</section>
<section id="model-comparison" class="level1">
<h1>Model Comparison</h1>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained=</span>uncSIM,</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained=</span>orcSIM_Poisson,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinationConstrained=</span>decSIM,</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained=</span>dbcSIM_Poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |     RMSE
-----------------------------------------
unconstrained          |   glm | 1587.622
originConstrained      |   glm | 1376.429
destinationConstrained |   glm | 1484.821
doublyConstrained      |   glm | 1167.214</code></pre>
</div>
</div>
<p>From the different RMSE calculated above, we can see that the doubly constrained model has the lowest RMSE value, which represents the most accurate model out of the 4 tested models.</p>
</section>
<section id="visualisation" class="level1">
<h1>Visualisation</h1>
<section id="unconstrained" class="level2">
<h2 class="anchored" data-anchor-id="unconstrained">Unconstrained</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>d_f <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(d_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="origin-constrained" class="level2">
<h2 class="anchored" data-anchor-id="origin-constrained">Origin constrained</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>d_f <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM_Poisson<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(d_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="destination-constrained" class="level2">
<h2 class="anchored" data-anchor-id="destination-constrained">Destination constrained</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>d_f <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(d_f) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="doubly-constrained" class="level2">
<h2 class="anchored" data-anchor-id="doubly-constrained">Doubly constrained</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>d_f <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM_Poisson<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(d_f) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>inter_zonal_flow <span class="ot">&lt;-</span> inter_zonal_flow <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM.fitted.values"</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">orcTRIPS =</span> <span class="st">"orcSIM_Poisson.fitted.values"</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">decTRIPS =</span> <span class="st">"decSIM.fitted.values"</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM_Poisson.fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotting" class="level2">
<h2 class="anchored" data-anchor-id="plotting">Plotting</h2>
<div class="cell">
<details>
<summary>code chunk</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> inter_zonal_flow,</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(unc_p, orc_p, dec_p, dbc_p,</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take_home_Ex2_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>